var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,s=(e,t)=>{for(var n in t||(t={}))i.call(t,n)&&a(e,n,t[n]);if(r)for(var n of r(t))o.call(t,n)&&a(e,n,t[n]);return e},u=(e,r)=>t(e,n(r)),c=(e,t)=>{var n={};for(var a in e)i.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&r)for(var a of r(e))t.indexOf(a)<0&&o.call(e,a)&&(n[a]=e[a]);return n};import l from"./RootQuery.graphql.a12ca9e4.js";import{b as d,t as h,a as f,j as p,v as y,S as v,G as g,M as m,P as b,R as _,w as k,x as E,f as S,y as x,z as w,B as C,D as I,E as T,H as K,I as O,J as P,s as R,K as L}from"./vendor.3327476c.js";import{s as A,i as M,a as N,R as D,H,G as F,g as U,b as j,c as B}from"./index.8067df7e.js";import{S as V,u as q,a as G,v as z,b as $,c as W,E as J,d as X,e as Q,f as Y,g as Z,h as ee,i as te}from"./hooks.f2bdd171.js";const ne=({children:e,title:t,onRefresh:n,datasetSelectorProps:r})=>{const[i,o]=d.exports.useState(!1),a=h({transform:i?"rotate(0turn)":"rotate(1turn)"});return f("div",{className:A.header,children:[f("div",{className:A.left,children:[f("div",{className:A.title,onClick:()=>{o(!i),n&&n()},children:[p(y.img,{className:A.logo,style:a,src:"/assets/logo.c7dc2f64.png"}),p("div",{className:A.fiftyone,children:t})]}),r&&p("div",{className:A.dataset,children:p(V,s({inputStyle:{height:40,maxWidth:300},containerStyle:{position:"relative"},inputClassName:A.input,overflow:!0},r))})]}),e]})},re=e=>{var t=e,{href:n}=t,r=c(t,["href"]);const i=(e=>{if(!e)return;let t;if(M())try{t=require("electron").shell.openExternal}catch{}return void 0!==t?n=>{n.preventDefault(),t(e)}:void 0})(n);return p("a",u(s({},r),{href:n,target:"_blank",onClick:i}))},ie=()=>p(re,{className:N,href:"https://join.slack.com/t/fiftyone-users/shared_invite/zt-s6936w7b-2R5eVPJoUw008wP7miJmPQ",title:"Slack",children:p(v,{children:p("path",{d:"M6 15a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2h2v2m1 0a2 2 0 0 1 2-2a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2a2 2 0 0 1-2-2v-5m2-8a2 2 0 0 1-2-2a2 2 0 0 1 2-2a2 2 0 0 1 2 2v2H9m0 1a2 2 0 0 1 2 2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2a2 2 0 0 1 2-2h5m8 2a2 2 0 0 1 2-2a2 2 0 0 1 2 2a2 2 0 0 1-2 2h-2v-2m-1 0a2 2 0 0 1-2 2a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2a2 2 0 0 1 2 2v5m-2 8a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2v-2h2m0-1a2 2 0 0 1-2-2a2 2 0 0 1 2-2h5a2 2 0 0 1 2 2a2 2 0 0 1-2 2h-5z"})})}),oe=()=>p(re,{className:N,title:"GitHub",href:"https://github.com/voxel51/fiftyone",children:p(g,{})}),ae=()=>p(re,{className:N,title:"Documentation",href:"https://voxel51.com/docs/fiftyone/user_guide/app.html",children:p(m,{})}),se=e=>{const t=d.exports.useContext(D),[n,r]=d.exports.useTransition(),i=d.exports.useCallback((n=>{n.preventDefault(),r((()=>{t.history.push(e.to)}))}),[e.to,t]),o=d.exports.useCallback((()=>{t.preload(e.to)}),[e.to,t]);return p("a",{href:e.to,onClick:i,onMouseEnter:o,style:e.style,className:e.className,title:e.title,children:e.children})},ue={fragment:{argumentDefinitions:ce=[{defaultValue:null,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:null,kind:"LocalArgument",name:"search"}],kind:"Fragment",metadata:null,name:"DatasetsPaginationQuery",selections:[{args:null,kind:"FragmentSpread",name:"RootDatasets_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:ce,kind:"Operation",name:"DatasetsPaginationQuery",selections:[{alias:null,args:le=[{kind:"Variable",name:"after",variableName:"cursor"},{kind:"Variable",name:"first",variableName:"count"},{kind:"Variable",name:"search",variableName:"search"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:le,filters:["search"],handle:"connection",key:"DatasetsList_query_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"1e0b621671e78c21b0947dcfa72dd51e",id:null,metadata:{},name:"DatasetsPaginationQuery",operationKind:"query",text:"query DatasetsPaginationQuery(\n  $count: Int\n  $cursor: String\n  $search: String\n) {\n  ...RootDatasets_query\n}\n\nfragment RootDatasets_query on Query {\n  datasets(search: $search, first: $count, after: $cursor) {\n    total\n    edges {\n      cursor\n      node {\n        name\n        id\n        __typename\n      }\n    }\n    pageInfo {\n      endCursor\n      hasNextPage\n    }\n  }\n}\n"}};var ce,le;ue.hash="280afc557752c2245a140c58ccb00248";const de=function(){var e=["datasets"];return{argumentDefinitions:[{kind:"RootArgument",name:"count"},{kind:"RootArgument",name:"cursor"},{kind:"RootArgument",name:"search"}],kind:"Fragment",metadata:{connection:[{count:"count",cursor:"cursor",direction:"forward",path:e}],refetch:{connection:{forward:{count:"count",cursor:"cursor"},backward:null,path:e},fragmentPathInResult:[],operation:ue}},name:"RootDatasets_query",selections:[{alias:"datasets",args:[{kind:"Variable",name:"search",variableName:"search"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsList_query_datasets_connection",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();function he(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var r=function(e,t){void 0===t&&(t=0);var n=d.exports.useRef(!1),r=d.exports.useRef(),i=d.exports.useRef(e),o=d.exports.useCallback((function(){return n.current}),[]),a=d.exports.useCallback((function(){n.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){n.current=!0,i.current()}),t)}),[t]),s=d.exports.useCallback((function(){n.current=null,r.current&&clearTimeout(r.current)}),[]);return d.exports.useEffect((function(){i.current=e}),[e]),d.exports.useEffect((function(){return a(),s}),[t]),[o,s,a]}(e,t),i=r[0],o=r[1],a=r[2];return d.exports.useEffect(a,n),[i,o]}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */de.hash="280afc557752c2245a140c58ccb00248";var fe=function(){return(fe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function pe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function ye(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ve(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function ge(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var me={};function be(e){return Object.keys(e)}function _e(e,t,n){void 0===n&&(n=".");var r=Se(e,n),i=Se(t,n);return He(i)?!!He(r)&&i===r:He(r)?r in i:be(r).every((function(e){return e in i&&_e(r[e],i[e])}))}function ke(e){try{return He(e)||"number"==typeof e?""+e:e.type}catch(t){throw new Error("Events must be strings or objects with a string event.type property.")}}function Ee(e,t){try{return Ne(e)?e:e.toString().split(t)}catch(n){throw new Error("'"+e+"' is not a valid state path.")}}function Se(e,t){return"object"==typeof(n=e)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?e.value:Ne(e)?xe(e):"string"!=typeof e?e:xe(Ee(e,t));var n}function xe(e){if(1===e.length)return e[0];for(var t={},n=t,r=0;r<e.length-1;r++)r===e.length-2?n[e[r]]=e[r+1]:(n[e[r]]={},n=n[e[r]]);return t}function we(e,t){for(var n={},r=be(e),i=0;i<r.length;i++){var o=r[i];n[o]=t(e[o],o,e,i)}return n}function Ce(e,t,n){var r,i,o={};try{for(var a=ye(be(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];n(c)&&(o[u]=t(c,u,e))}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var Ie=function(e){return function(t){var n,r,i=t;try{for(var o=ye(e),a=o.next();!a.done;a=o.next()){i=i[a.value]}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function Te(e){return e?He(e)?[[e]]:Ke(be(e).map((function(t){var n=e[t];return"string"==typeof n||n&&Object.keys(n).length?Te(e[t]).map((function(e){return[t].concat(e)})):[[t]]}))):[[]]}function Ke(e){var t;return(t=[]).concat.apply(t,ge([],ve(e)))}function Oe(e){return Ne(e)?e:[e]}function Pe(e){return void 0===e?[]:Oe(e)}function Re(e,t,n){var r,i;if(De(e))return e(t,n.data);var o={};try{for(var a=ye(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];De(c)?o[u]=c(t,n.data):o[u]=c}}catch(l){r={error:l}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function Le(e){return e instanceof Promise||!(null===e||!De(e)&&"object"!=typeof e||!De(e.then))}function Ae(e,t){var n,r,i=ve([[],[]],2),o=i[0],a=i[1];try{for(var s=ye(e),u=s.next();!u.done;u=s.next()){var c=u.value;t(c)?o.push(c):a.push(c)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}function Me(e,t){return we(e.states,(function(e,n){if(e){var r=(He(t)?void 0:t[n])||(e?e.current:void 0);if(r)return{current:r,states:Me(e,r)}}}))}function Ne(e){return Array.isArray(e)}function De(e){return"function"==typeof e}function He(e){return"string"==typeof e}function Fe(e,t){if(e)return He(e)?{type:"xstate.guard",name:e,predicate:t?t[e]:void 0}:De(e)?{type:"xstate.guard",name:e.name,predicate:e}:e}var Ue=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function je(e){try{return"__xstatenode"in e}catch(t){return!1}}var Be,Ve,qe,Ge,ze=function(){var e=0;return function(){return(++e).toString(16)}}();function $e(e,t){return He(e)||"number"==typeof e?fe({type:e},t):e}function We(e,t){if(!He(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var n=$e(e);return fe({name:n.type,data:n,$$type:"scxml",type:"external"},t)}function Je(e,t){return Oe(t).map((function(t){return void 0===t||"string"==typeof t||je(t)?{target:t,event:e}:fe(fe({},t),{event:e})}))}function Xe(e,t,n,r,i){var o=e.options.guards,a={state:i,cond:t,_event:r};if("xstate.guard"===t.type)return t.predicate(n,r.data,a);var s=o[t.type];if(!s)throw new Error("Guard '"+t.type+"' is not implemented on machine '"+e.id+"'.");return s(n,r.data,a)}function Qe(e){return"string"==typeof e?{type:e}:e}function Ye(e,t,n){if("object"==typeof e)return e;var r=function(){};return{next:e,error:t||r,complete:n||r}}(Ve=Be||(Be={})).Start="xstate.start",Ve.Stop="xstate.stop",Ve.Raise="xstate.raise",Ve.Send="xstate.send",Ve.Cancel="xstate.cancel",Ve.NullEvent="",Ve.Assign="xstate.assign",Ve.After="xstate.after",Ve.DoneState="done.state",Ve.DoneInvoke="done.invoke",Ve.Log="xstate.log",Ve.Init="xstate.init",Ve.Invoke="xstate.invoke",Ve.ErrorExecution="error.execution",Ve.ErrorCommunication="error.communication",Ve.ErrorPlatform="error.platform",Ve.ErrorCustom="xstate.error",Ve.Update="xstate.update",Ve.Pure="xstate.pure",Ve.Choose="xstate.choose",(Ge=qe||(qe={})).Parent="#_parent",Ge.Internal="#_internal";var Ze=Be.Start,et=Be.Stop,tt=Be.Raise,nt=Be.Send,rt=Be.Cancel,it=Be.NullEvent,ot=Be.Assign;Be.After,Be.DoneState;var at=Be.Log,st=Be.Init,ut=Be.Invoke;Be.ErrorExecution;var ct=Be.ErrorPlatform,lt=Be.ErrorCustom,dt=Be.Update,ht=Be.Choose,ft=Be.Pure,pt=We({type:st});function yt(e,t){return t&&t[e]||void 0}function vt(e,t){var n;if(He(e)||"number"==typeof e){var r=yt(e,t);n=De(r)?{type:e,exec:r}:r||{type:e,exec:void 0}}else if(De(e))n={type:e.name||e.toString(),exec:e};else{if(De(r=yt(e.type,t)))n=fe(fe({},e),{exec:r});else if(r){var i=r.type||e.type;n=fe(fe(fe({},r),e),{type:i})}else n=e}return Object.defineProperty(n,"toString",{value:function(){return n.type},enumerable:!1,configurable:!0}),n}var gt=function(e,t){return e?(Ne(e)?e:[e]).map((function(e){return vt(e,t)})):[]};function mt(e){var t=vt(e);return fe(fe({id:He(e)?e:t.id},t),{type:t.type})}function bt(e){return He(e)?{type:tt,event:e}:_t(e,{to:qe.Internal})}function _t(e,t){return{to:t?t.to:void 0,type:nt,event:De(e)?e:$e(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:De(e)?e.name:ke(e)}}function kt(e,t){return _t(e,fe(fe({},t),{to:qe.Parent}))}var Et=function(e,t){return{context:e,event:t}};var St=function(e){return{type:rt,sendId:e}};function xt(e){var t=mt(e);return{type:Be.Start,activity:t,exec:void 0}}function wt(e){var t=De(e)?e:mt(e);return{type:Be.Stop,activity:t,exec:void 0}}var Ct=function(e){return{type:ot,assignment:e}};function It(e,t){var n=t?"#"+t:"";return Be.After+"("+e+")"+n}function Tt(e,t){var n=Be.DoneState+"."+e,r={type:n,data:t,toString:function(){return n}};return r}function Kt(e,t){var n=Be.DoneInvoke+"."+e,r={type:n,data:t,toString:function(){return n}};return r}function Ot(e,t){var n=Be.ErrorPlatform+"."+e,r={type:n,data:t,toString:function(){return n}};return r}function Pt(e,t,n,r,i){var o=ve(Ae(i,(function(e){return e.type===ot})),2),a=o[0],s=o[1],u=a.length?function(e,t,n,r){return e?n.reduce((function(e,n){var i,o,a=n.assignment,s={state:r,action:n,_event:t},u={};if(De(a))u=a(e,t.data,s);else try{for(var c=ye(be(a)),l=c.next();!l.done;l=c.next()){var d=l.value,h=a[d];u[d]=De(h)?h(e,t.data,s):h}}catch(f){i={error:f}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return Object.assign({},e,u)}),e):e}(n,r,a,t):n;return[Ke(s.map((function(n){var i;switch(n.type){case tt:return{type:tt,_event:We(n.event)};case nt:return function(e,t,n,r){var i,o={_event:n},a=We(De(e.event)?e.event(t,n.data,o):e.event);if(He(e.delay)){var s=r&&r[e.delay];i=De(s)?s(t,n.data,o):s}else i=De(e.delay)?e.delay(t,n.data,o):e.delay;var u=De(e.to)?e.to(t,n.data,o):e.to;return fe(fe({},e),{to:u,_event:a,event:a.data,delay:i})}(n,u,r,e.options.delays);case at:return function(e,t,n){return fe(fe({},e),{value:He(e.expr)?e.expr:e.expr(t,n.data,{_event:n})})}(n,u,r);case ht:if(!(a=null===(i=n.conds.find((function(n){var i=Fe(n.cond,e.options.guards);return!i||Xe(e,i,u,r,t)})))||void 0===i?void 0:i.actions))return[];var o=Pt(e,t,u,r,gt(Pe(a),e.options.actions));return u=o[1],o[0];case ft:var a;if(!(a=n.get(u,r.data)))return[];o=Pt(e,t,u,r,gt(Pe(a),e.options.actions));return u=o[1],o[0];case et:return function(e,t,n){var r=De(e.activity)?e.activity(t,n.data):e.activity,i="string"==typeof r?{id:r}:r;return{type:Be.Stop,activity:i}}(n,u,r);default:return vt(n,e.options.actions)}}))),u]}var Rt=function(e){return"atomic"===e.type||"final"===e.type};function Lt(e){return be(e.states).map((function(t){return e.states[t]}))}function At(e){var t=[e];return Rt(e)?t:t.concat(Ke(Lt(e).map(At)))}function Mt(e,t){var n,r,i,o,a,s,u,c,l=Dt(new Set(e)),d=new Set(t);try{for(var h=ye(d),f=h.next();!f.done;f=h.next())for(var p=(S=f.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}catch(x){n={error:x}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}var y=Dt(d);try{for(var v=ye(d),g=v.next();!g.done;g=v.next()){if("compound"!==(S=g.value).type||y.get(S)&&y.get(S).length){if("parallel"===S.type)try{for(var m=(a=void 0,ye(Lt(S))),b=m.next();!b.done;b=m.next()){var _=b.value;"history"!==_.type&&(d.has(_)||(d.add(_),l.get(_)?l.get(_).forEach((function(e){return d.add(e)})):_.initialStateNodes.forEach((function(e){return d.add(e)}))))}}catch(w){a={error:w}}finally{try{b&&!b.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}else l.get(S)?l.get(S).forEach((function(e){return d.add(e)})):S.initialStateNodes.forEach((function(e){return d.add(e)}))}}catch(C){i={error:C}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var k=ye(d),E=k.next();!E.done;E=k.next()){var S;for(p=(S=E.value).parent;p&&!d.has(p);)d.add(p),p=p.parent}}catch(I){u={error:I}}finally{try{E&&!E.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}return d}function Nt(e,t){var n=t.get(e);if(!n)return{};if("compound"===e.type){var r=n[0];if(!r)return{};if(Rt(r))return r.key}var i={};return n.forEach((function(e){i[e.key]=Nt(e,t)})),i}function Dt(e){var t,n,r=new Map;try{for(var i=ye(e),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Ht(e,t){return Nt(e,Dt(Mt([e],t)))}function Ft(e,t){return Array.isArray(e)?e.some((function(e){return e===t})):e instanceof Set&&e.has(t)}function Ut(e,t){return"compound"===t.type?Lt(t).some((function(t){return"final"===t.type&&Ft(e,t)})):"parallel"===t.type&&Lt(t).every((function(t){return Ut(e,t)}))}function jt(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(He(e)||He(t))return e===t;var n=be(e),r=be(t);return n.length===r.length&&n.every((function(n){return jt(e[n],t[n])}))}var Bt=function(){function e(e){var t,n,r=this;this.actions=[],this.activities=me,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||me,this.meta=(void 0===(n=e.configuration)&&(n=[]),n.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=e.tags)&&void 0!==t?t:new Set,Object.defineProperty(this,"nextEvents",{get:function(){return function(e){return ge([],ve(new Set(Ke(ge([],ve(e.map((function(e){return e.ownEvents}))))))))}(r.configuration)}})}return e.from=function(t,n){return t instanceof e?t.context!==n?new e({value:t.value,context:n,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:n,_event:pt,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,n){if(t instanceof e){if(!t.actions.length)return t;var r=pt;return new e({value:t.value,context:n,_event:r,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,n)},e.prototype.toStrings=function(e,t){var n=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),He(e))return[e];var r=be(e);return r.concat.apply(r,ge([],ve(r.map((function(r){return n.toStrings(e[r],t).map((function(e){return r+t+e}))})))))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags,n=pe(e,["configuration","transitions","tags"]);return fe(fe({},n),{tags:Array.from(t)})},e.prototype.matches=function(e){return _e(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e}(),Vt=[],qt=function(e,t){Vt.push(e);var n=t(e);return Vt.pop(),n};function Gt(e){return{id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}}}function zt(e,t,n){var r=Gt(t);if(r.deferred=!0,je(e)){var i=r.state=qt(void 0,(function(){return(n?e.withContext(n):e).initialState}));r.getSnapshot=function(){return i}}return r}function $t(e){if("string"==typeof e){var t={type:e,toString:function(){return e}};return t}return e}function Wt(e){return fe(fe({type:ut},e),{toJSON:function(){e.onDone,e.onError;var t=pe(e,["onDone","onError"]);return fe(fe({},t),{type:ut,src:$t(e.src)})}})}var Jt={},Xt=function(e){return"#"===e[0]},Qt=function(){function e(t,n,r){var i,o=this;void 0===r&&(r=t.context),this.config=t,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=this.options._parent,this.key=this.config.key||this.options._key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||ge([this.machine.key],ve(this.path)).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&be(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(i=this.config.schema)&&void 0!==i?i:{},this.initial=this.config.initial,this.states=this.config.states?we(this.config.states,(function(t,n){var r,i=new e(t,{_parent:o,_key:n});return Object.assign(o.idMap,fe(((r={})[i.id]=i,r),i.idMap)),i})):Jt;var a=0;!function e(t){var n,r;t.order=a++;try{for(var i=ye(Lt(t)),o=i.next();!o.done;o=i.next()){e(o.value)}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(e){return""===e.event})):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=Pe(this.config.entry||this.config.onEntry).map((function(e){return vt(e)})),this.onExit=Pe(this.config.exit||this.config.onExit).map((function(e){return vt(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=Pe(this.config.invoke).map((function(e,t){var n,r;if(je(e))return o.machine.options.services=fe(((n={})[e.id]=e,n),o.machine.options.services),Wt({src:e.id,id:e.id});if(He(e.src))return Wt(fe(fe({},e),{id:e.id||e.src,src:e.src}));if(je(e.src)||De(e.src)){var i=o.id+":invocation["+t+"]";return o.machine.options.services=fe(((r={})[i]=e.src,r),o.machine.options.services),Wt(fe(fe({id:i},e),{src:i}))}var a=e.src;return Wt(fe(fe({id:a.type},e),{src:a}))})),this.activities=Pe(this.config.activities).concat(this.invoke).map((function(e){return mt(e)})),this.transition=this.transition.bind(this),this.tags=Pe(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||At(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,n){var r=this.options,i=r.actions,o=r.activities,a=r.guards,s=r.services,u=r.delays;return new e(this.config,{actions:fe(fe({},i),t.actions),activities:fe(fe({},o),t.activities),guards:fe(fe({},a),t.guards),services:fe(fe({},s),t.services),delays:fe(fe({},u),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return De(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:we(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=""===e,n=this.transitions.filter((function(n){var r=n.eventType===e;return t?r:r||"*"===n.eventType}));return this.__cache.candidates[e]=n,n},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var n=function(t,n){var r=It(De(t)?e.id+":delay["+n+"]":t,e.id);return e.onEntry.push(_t(r,{delay:t})),e.onExit.push(St(r)),r};return(Ne(t)?t.map((function(e,t){var r=n(e.delay,t);return fe(fe({},e),{event:r})})):Ke(be(t).map((function(e,r){var i=t[e],o=He(i)?{target:i}:i,a=isNaN(+e)?e:+e,s=n(a,r);return Pe(o).map((function(e){return fe(fe({},e),{event:s,delay:a})}))})))).map((function(t){var n=t.delay;return fe(fe({},e.formatTransition(t)),{delay:n})}))},e.prototype.getStateNodes=function(e){var t,n=this;if(!e)return[];var r=e instanceof Bt?e.value:Se(e,this.delimiter);if(He(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((t={})[r]=i,t)):[this,this.states[r]]}var o=be(r),a=o.map((function(e){return n.getStateNode(e)}));return a.push(this),a.concat(o.reduce((function(e,t){var i=n.getStateNode(t).getStateNodes(r[t]);return e.concat(i)}),[]))},e.prototype.handles=function(e){var t=ke(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=Array.from(Mt([],this.getStateNodes(e.value)));return new Bt(fe(fe({},e),{value:this.resolve(e.value),configuration:t,done:Ut(t,this)}))},e.prototype.transitionLeafNode=function(e,t,n){var r=this.getStateNode(e).next(t,n);return r&&r.transitions.length?r:this.next(t,n)},e.prototype.transitionCompoundNode=function(e,t,n){var r=be(e),i=this.getStateNode(r[0])._transition(e[r[0]],t,n);return i&&i.transitions.length?i:this.next(t,n)},e.prototype.transitionParallelNode=function(e,t,n){var r,i,o={};try{for(var a=ye(be(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];if(c){var l=this.getStateNode(u)._transition(c,t,n);l&&(o[u]=l)}}}catch(y){r={error:y}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var d=be(o).map((function(e){return o[e]})),h=Ke(d.map((function(e){return e.transitions})));if(!d.some((function(e){return e.transitions.length>0})))return this.next(t,n);var f=Ke(d.map((function(e){return e.entrySet}))),p=Ke(be(o).map((function(e){return o[e].configuration})));return{transitions:h,entrySet:f,exitSet:Ke(d.map((function(e){return e.exitSet}))),configuration:p,source:t,actions:Ke(be(o).map((function(e){return o[e].actions})))}},e.prototype._transition=function(e,t,n){return He(e)?this.transitionLeafNode(e,t,n):1===be(e).length?this.transitionCompoundNode(e,t,n):this.transitionParallelNode(e,t,n)},e.prototype.next=function(e,t){var n,r,i,o=this,a=t.name,s=[],u=[];try{for(var c=ye(this.getCandidates(a)),l=c.next();!l.done;l=c.next()){var d=l.value,h=d.cond,f=d.in,p=e.context,y=!f||(He(f)&&Xt(f)?e.matches(Se(this.getStateNodeById(f).path,this.delimiter)):_e(Se(f,this.delimiter),Ie(this.path.slice(0,-2))(e.value))),v=!1;try{v=!h||Xe(this.machine,h,p,t,e)}catch(b){throw new Error("Unable to evaluate guard '"+(h.name||h.type)+"' in transition for event '"+a+"' in state node '"+this.id+"':\n"+b.message)}if(v&&y){void 0!==d.target&&(u=d.target),s.push.apply(s,ge([],ve(d.actions))),i=d;break}}}catch(_){n={error:_}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}if(i){if(!u.length)return{transitions:[i],entrySet:[],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var g=Ke(u.map((function(t){return o.getRelativeStateNodes(t,e.historyValue)}))),m=!!i.internal;return{transitions:[i],entrySet:m?[]:Ke(g.map((function(e){return o.nodesFromChild(e)}))),exitSet:m?[]:[this],configuration:g,source:e,actions:s}}},e.prototype.nodesFromChild=function(e){if(e.escapes(this))return[];for(var t=[],n=e;n&&n!==this;)t.push(n),n=n.parent;return t.push(this),t},e.prototype.escapes=function(e){if(this===e)return!1;for(var t=this.parent;t;){if(t===e)return!1;t=t.parent}return!0},e.prototype.getActions=function(e,t,n,r){var i,o,a,s,u=Mt([],r?this.getStateNodes(r.value):[this]),c=e.configuration.length?Mt(u,e.configuration):u;try{for(var l=ye(c),d=l.next();!d.done;d=l.next()){Ft(u,p=d.value)||e.entrySet.push(p)}}catch(k){i={error:k}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}try{for(var h=ye(u),f=h.next();!f.done;f=h.next()){var p;Ft(c,p=f.value)&&!Ft(e.exitSet,p.parent)||e.exitSet.push(p)}}catch(E){a={error:E}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}e.source||(e.exitSet=[],e.entrySet.push(this));var y=Ke(e.entrySet.map((function(r){var i=[];if("final"!==r.type)return i;var o=r.parent;if(!o.parent)return i;i.push(Tt(r.id,r.doneData),Tt(o.id,r.doneData?Re(r.doneData,t,n):void 0));var a=o.parent;return"parallel"===a.type&&Lt(a).every((function(t){return Ut(e.configuration,t)}))&&i.push(Tt(a.id)),i})));e.exitSet.sort((function(e,t){return t.order-e.order})),e.entrySet.sort((function(e,t){return e.order-t.order}));var v=new Set(e.entrySet),g=new Set(e.exitSet),m=ve([Ke(Array.from(v).map((function(e){return ge(ge([],ve(e.activities.map((function(e){return xt(e)})))),ve(e.onEntry))}))).concat(y.map(bt)),Ke(Array.from(g).map((function(e){return ge(ge([],ve(e.onExit)),ve(e.activities.map((function(e){return wt(e)}))))})))],2),b=m[0],_=m[1];return gt(_.concat(e.actions).concat(b),this.machine.options.actions)},e.prototype.transition=function(e,t,n){void 0===e&&(e=this.initialState);var r,i,o=We(t);if(e instanceof Bt)r=void 0===n?e:this.resolveState(Bt.from(e,n));else{var a=He(e)?this.resolve(xe(this.getResolvedPath(e))):this.resolve(e),s=null!=n?n:this.machine.context;r=this.resolveState(Bt.from(a,s))}if(this.strict&&!this.events.includes(o.name)&&(i=o.name,!/^(done|error)\./.test(i)))throw new Error("Machine '"+this.id+"' does not accept event '"+o.name+"'");var u=this._transition(r.value,r,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:r,actions:[]},c=Mt([],this.getStateNodes(r.value)),l=u.configuration.length?Mt(c,u.configuration):c;return u.configuration=ge([],ve(l)),this.resolveTransition(u,r,o)},e.prototype.resolveRaisedTransition=function(e,t,n){var r,i=e.actions;return(e=this.transition(e,t))._event=n,e.event=n.data,(r=e.actions).unshift.apply(r,ge([],ve(i))),e},e.prototype.resolveTransition=function(e,t,n,r){var i,o,a=this;void 0===n&&(n=pt),void 0===r&&(r=this.machine.context);var s=e.configuration,u=!t||e.transitions.length>0,c=u?Ht(this.machine,s):void 0,l=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,d=t?t.context:r,h=this.getActions(e,d,n,t),f=t?fe({},t.activities):{};try{for(var p=ye(h),y=p.next();!y.done;y=p.next()){var v=y.value;v.type===Ze?f[v.activity.id||v.activity.type]=v:v.type===et&&(f[v.activity.id||v.activity.type]=!1)}}catch(M){i={error:M}}finally{try{y&&!y.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}var g,m,b=ve(Pt(this,t,d,n,h),2),_=b[0],k=b[1],E=ve(Ae(_,(function(e){return e.type===tt||e.type===nt&&e.to===qe.Internal})),2),S=E[0],x=E[1],w=_.filter((function(e){var t;return e.type===Ze&&(null===(t=e.activity)||void 0===t?void 0:t.type)===ut})).reduce((function(e,t){return e[t.activity.id]=function(e,t,n,r){var i,o=Qe(e.src),a=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[o.type],s=e.data?Re(e.data,n,r):void 0,u=a?zt(a,e.id,s):Gt(e.id);return u.meta=e,u}(t.activity,a.machine,k,n),e}),t?fe({},t.children):{}),C=c?e.configuration:t?t.configuration:[],I=Ut(C,this),T=new Bt({value:c||t.value,context:k,_event:n,_sessionid:t?t._sessionid:null,historyValue:c?l?(g=l,m=c,{current:m,states:Me(g,m)}):void 0:t?t.historyValue:void 0,history:!c||e.source?t:void 0,actions:c?x:[],activities:c?f:t?t.activities:{},events:[],configuration:C,transitions:e.transitions,children:w,done:I,tags:null==t?void 0:t.tags}),K=d!==k;T.changed=n.name===dt||K;var O=T.history;O&&delete O.history;var P=!I&&(this._transient||s.some((function(e){return e._transient})));if(!(u||P&&""!==n.name))return T;var R=T;if(!I)for(P&&(R=this.resolveRaisedTransition(R,{type:it},n));S.length;){var L=S.shift();R=this.resolveRaisedTransition(R,L._event,n)}var A=R.changed||(O?!!R.actions.length||K||typeof O.value!=typeof R.value||!jt(R.value,O.value):void 0);return R.changed=A,R.history=O,R.tags=new Set(Ke(R.configuration.map((function(e){return e.tags})))),R},e.prototype.getStateNode=function(e){if(Xt(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '"+e+"' from '"+this.id+"'; no child states exist.");var t=this.states[e];if(!t)throw new Error("Child state '"+e+"' does not exist on '"+this.id+"'");return t},e.prototype.getStateNodeById=function(e){var t=Xt(e)?e.slice("#".length):e;if(t===this.id)return this;var n=this.machine.idMap[t];if(!n)throw new Error("Child state node '#"+t+"' does not exist on machine '"+this.id+"'");return n},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&Xt(e))try{return this.getStateNodeById(e.slice(1))}catch(i){}for(var t=Ee(e,this.delimiter).slice(),n=this;t.length;){var r=t.shift();if(!r.length)break;n=n.getStateNode(r)}return n},e.prototype.resolve=function(e){var t,n=this;if(!e)return this.initialStateValue||Jt;switch(this.type){case"parallel":return we(this.initialStateValue,(function(t,r){return t?n.getStateNode(r).resolve(e[r]||t):Jt}));case"compound":if(He(e)){var r=this.getStateNode(e);return"parallel"===r.type||"compound"===r.type?((t={})[e]=r.initialStateValue,t):e}return be(e).length?we(e,(function(e,t){return e?n.getStateNode(t).resolve(e):Jt})):this.initialStateValue||{};default:return e||Jt}},e.prototype.getResolvedPath=function(e){if(Xt(e)){var t=this.machine.idMap[e.slice("#".length)];if(!t)throw new Error("Unable to find state node '"+e+"'");return t.path}return Ee(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=Ce(this.states,(function(e){return e.initialStateValue||Jt}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '"+this.initial+"' not found on '"+this.key+"'");t=Rt(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,t)},Object.defineProperty(e.prototype,"initialState",{get:function(){this._init();var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '"+this.id+"'.");return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=He(t.target)&&Xt(t.target)?xe(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,n){return void 0===n&&(n=!0),n?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return Rt(this)?[this]:"compound"!==this.type||this.initial?Ke(Te(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):[this]},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=ve(e),n=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '"+n+"' from node with no states");var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '"+n+"' does not exist on '"+this.id+"'");return this.states[n].getFromRelativePath(r)},e.prototype.historyValue=function(e){if(be(this.states).length)return{current:e||this.initialStateValue,states:Ce(this.states,(function(t,n){if(!e)return t.historyValue();var r=He(e)?void 0:e[n];return t.historyValue(r||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var r=this.target;return r?Ke(Te(r).map((function(e){return n.getFromRelativePath(e)}))):n.initialStateNodes}var i,o,a=(i=n.path,o="states",function(e){var t,n,r=e;try{for(var a=ye(i),s=a.next();!s.done;s=a.next()){var u=s.value;r=r[o][u]}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r})(e).current;return He(a)?[n.getStateNode(a)]:Ke(Te(a).map((function(e){return"deep"===t.history?n.getFromRelativePath(e):[n.states[e[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=Ke(be(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var e,t,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,o=new Set(this.ownEvents);if(i)try{for(var a=ye(be(i)),s=a.next();!s.done;s=a.next()){var u=i[s.value];if(u.states)try{for(var c=(n=void 0,ye(u.events)),l=c.next();!l.done;l=c.next()){var d=l.value;o.add(""+d)}}catch(h){n={error:h}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return Array.from(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!He(e))return e;var n=e[0]===t.delimiter;if(n&&!t.parent)return t.getStateNodeByPath(e.slice(1));var r=n?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(r);try{return t.parent.getStateNodeByPath(r)}catch(i){throw new Error("Invalid transition definition for state node '"+t.id+"':\n"+i.message)}}))},e.prototype.formatTransition=function(e){var t=this,n=function(e){if(void 0!==e&&""!==e)return Pe(e)}(e.target),r="internal"in e?e.internal:!n||n.some((function(e){return He(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,o=this.resolveTarget(n),a=fe(fe({},e),{actions:gt(Pe(e.actions)),cond:Fe(e.cond,i),target:o,source:this,internal:r,eventType:e.event,toJSON:function(){return fe(fe({},a),{target:a.target?a.target.map((function(e){return"#"+e.id})):void 0,source:"#"+t.id})}});return a},e.prototype.formatTransitions=function(){var e,t,n,r=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var i=this.config.on,o="*",a=i[o],s=void 0===a?[]:a,u=pe(i,["*"]);n=Ke(be(u).map((function(e){return Je(e,u[e])})).concat(Je("*",s)))}else n=[];var c=this.config.always?Je("",this.config.always):[],l=this.config.onDone?Je(String(Tt(this.id)),this.config.onDone):[],d=Ke(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,ge([],ve(Je(String(Kt(e.id)),e.onDone)))),e.onError&&t.push.apply(t,ge([],ve(Je(String(Ot(e.id)),e.onError)))),t}))),h=this.after,f=Ke(ge(ge(ge(ge([],ve(l)),ve(d)),ve(n)),ve(c)).map((function(e){return Pe(e).map((function(e){return r.formatTransition(e)}))})));try{for(var p=ye(h),y=p.next();!y.done;y=p.next()){var v=y.value;f.push(v)}}catch(g){e={error:g}}finally{try{y&&!y.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}return f},e}();function Yt(e,t,n){return void 0===n&&(n=e.context),new Qt(e,t,n)}var Zt={deferEvents:!1},en=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=fe(fe({},Zt),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},e}(),tn=new Map,nn=0,rn=function(){return"x:"+nn++},on=function(e,t){return tn.set(e,t),e},an=function(e){return tn.get(e)},sn=function(e){tn.delete(e)};function un(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function cn(e){if(un()){var t=function(){var e=un();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}function ln(e,t){void 0===t&&(t={});var n,r=e.initialState,i=new Set,o=[],a=!1,s=(n={id:t.id,send:function(t){o.push(t),function(){if(!a){for(a=!0;o.length>0;){var t=o.shift();r=e.transition(r,t,u),i.forEach((function(e){return e.next(r)}))}a=!1}}()},getSnapshot:function(){return r},subscribe:function(e,t,n){var o=Ye(e,t,n);return i.add(o),o.next(r),{unsubscribe:function(){i.delete(o)}}}},fe({subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},n)),u={parent:t.parent,self:s,id:t.id||"anonymous",observers:i};return r=e.start?e.start(u):r,s}var dn,hn,fn={sync:!1,autoForward:!1};(hn=dn||(dn={}))[hn.NotStarted=0]="NotStarted",hn[hn.Running=1]="Running",hn[hn.Stopped=2]="Stopped";var pn=function(){function e(t,n){var r=this;void 0===n&&(n=e.defaultOptions),this.machine=t,this.scheduler=new en,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=dn.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(e,t){if(Ne(e))return r.batch(e),r.state;var n=We($e(e,t));if(r.status===dn.Stopped)return r.state;if(r.status!==dn.Running&&!r.options.deferEvents)throw new Error('Event "'+n.name+'" was sent to uninitialized service "'+r.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: '+JSON.stringify(n.data));return r.scheduler.schedule((function(){r.forward(n);var e=r.nextState(n);r.update(e,n)})),r._state},this.sendTo=function(e,t){var n,i=r.parent&&(t===qe.Parent||r.parent.id===t),o=i?r.parent:He(t)?r.children.get(t)||an(t):(n=t)&&"function"==typeof n.send?t:void 0;if(o)"machine"in o?o.send(fe(fe({},e),{name:e.name===lt?""+Ot(r.id):e.name,origin:r.sessionId})):o.send(e.data);else if(!i)throw new Error("Unable to send event to child '"+t+"' from service '"+r.id+"'.")};var i=fe(fe({},e.defaultOptions),n),o=i.clock,a=i.logger,s=i.parent,u=i.id,c=void 0!==u?u:t.id;this.id=c,this.logger=a,this.clock=o,this.parent=s,this.options=i,this.scheduler=new en({deferEvents:this.options.deferEvents}),this.sessionId=rn()}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:qt(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var n,r;try{for(var i=ye(e.actions),o=i.next();!o.done;o=i.next()){var a=o.value;this.exec(a,e,t)}}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.update=function(e,t){var n,r,i,o,a,s,u,c,l=this;if(e._sessionid=this.sessionId,this._state=e,this.options.execute&&this.execute(this.state),this.children.forEach((function(e){l.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var d=ye(this.eventListeners),h=d.next();!h.done;h=d.next()){(0,h.value)(e.event)}}catch(E){n={error:E}}finally{try{h&&!h.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var f=ye(this.listeners),p=f.next();!p.done;p=f.next()){(0,p.value)(e,e.event)}}catch(S){i={error:S}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}try{for(var y=ye(this.contextListeners),v=y.next();!v.done;v=y.next()){(0,v.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(x){a={error:x}}finally{try{v&&!v.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}var g=Ut(e.configuration||[],this.machine);if(this.state.configuration&&g){var m=e.configuration.find((function(e){return"final"===e.type&&e.parent===l.machine})),b=m&&m.doneData?Re(m.doneData,e.context,t):void 0;try{for(var _=ye(this.doneListeners),k=_.next();!k.done;k=_.next()){(0,k.value)(Kt(this.id,b))}}catch(w){u={error:w}}finally{try{k&&!k.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}this.stop()}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===dn.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,n){var r,i=this;if(!e)return{unsubscribe:function(){}};var o=n;return"function"==typeof e?r=e:(r=e.next.bind(e),o=e.complete.bind(e)),this.listeners.add(r),this.status===dn.Running&&r(this.state),o&&this.onDone(o),{unsubscribe:function(){r&&i.listeners.delete(r),o&&i.doneListeners.delete(o)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t=this;if(this.status===dn.Running)return this;on(this.sessionId,this),this.initialized=!0,this.status=dn.Running;var n=void 0===e?this.initialState:qt(this,(function(){return!He(n=e)&&"value"in n&&"history"in n?t.machine.resolveState(e):t.machine.resolveState(Bt.from(e,t.machine.context));var n}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){t.update(n,pt)})),this},e.prototype.stop=function(){var e,t,n,r,i,o,a,s,u,c,l=this;try{for(var d=ye(this.listeners),h=d.next();!h.done;h=d.next()){var f=h.value;this.listeners.delete(f)}}catch(S){e={error:S}}finally{try{h&&!h.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}try{for(var p=ye(this.stopListeners),y=p.next();!y.done;y=p.next()){(f=y.value)(),this.stopListeners.delete(f)}}catch(x){n={error:x}}finally{try{y&&!y.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}try{for(var v=ye(this.contextListeners),g=v.next();!g.done;g=v.next()){f=g.value;this.contextListeners.delete(f)}}catch(w){i={error:w}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}try{for(var m=ye(this.doneListeners),b=m.next();!b.done;b=m.next()){f=b.value;this.doneListeners.delete(f)}}catch(C){a={error:C}}finally{try{b&&!b.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.state.configuration.forEach((function(e){var t,n;try{for(var r=ye(e.definition.exit),i=r.next();!i.done;i=r.next()){var o=i.value;l.exec(o,l.state)}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}})),this.children.forEach((function(e){De(e.stop)&&e.stop()}));try{for(var _=ye(be(this.delayedEventsMap)),k=_.next();!k.done;k=_.next()){var E=k.value;this.clock.clearTimeout(this.delayedEventsMap[E])}}catch(I){u={error:I}}finally{try{k&&!k.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}return this.scheduler.clear(),this.initialized=!1,this.status=dn.Stopped,sn(this.sessionId),this},e.prototype.batch=function(e){var t=this;if(this.status===dn.NotStarted&&this.options.deferEvents);else if(this.status!==dn.Running)throw new Error(e.length+' event(s) were sent to uninitialized service "'+this.machine.id+'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.');this.scheduler.schedule((function(){var n,r,i=t.state,o=!1,a=[],s=function(e){var n=We(e);t.forward(n),i=qt(t,(function(){return t.machine.transition(i,n)})),a.push.apply(a,ge([],ve(i.actions.map((function(e){return n=i,r=(t=e).exec,fe(fe({},t),{exec:void 0!==r?function(){return r(n.context,n.event,{action:t,state:n,_event:n._event})}:void 0});var t,n,r}))))),o=o||!!i.changed};try{for(var u=ye(e),c=u.next();!c.done;c=u.next()){s(c.value)}}catch(l){n={error:l}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}i.changed=o,i.actions=a,t.update(i,We(e[e.length-1]))}))},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype.nextState=function(e){var t=this,n=We(e);if(0===n.name.indexOf(ct)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf(ct)})))throw n.data.data;return qt(this,(function(){return t.machine.transition(t.state,n)}))},e.prototype.forward=function(e){var t,n;try{for(var r=ye(this.forwardTo),i=r.next();!i.done;i=r.next()){var o=i.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '"+e+"' from interpreter '"+this.id+"' to nonexistant child '"+o+"'.");a.send(e)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this;this.delayedEventsMap[e.id]=this.clock.setTimeout((function(){e.to?t.sendTo(e._event,e.to):t.send(e._event)}),e.delay)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,n){void 0===n&&(n=this.machine.options.actions);var r=t.context,i=t._event,o=e.exec||yt(e.type,n),a=De(o)?o:o?o.exec:e.exec;if(a)try{return a(r,i.data,{action:e,state:this.state,_event:i})}catch(b){throw this.parent&&this.parent.send({type:"xstate.error",data:b}),b}switch(e.type){case nt:var s=e;if("number"==typeof s.delay)return void this.defer(s);s.to?this.sendTo(s._event,s.to):this.send(s._event);break;case rt:this.cancel(e.sendId);break;case Ze:var u=e.activity;if(!this.state.activities[u.id||u.type])break;if(u.type===Be.Invoke){var c=Qe(u.src),l=this.machine.options.services?this.machine.options.services[c.type]:void 0,d=u.id,h=u.data,f="autoForward"in u?u.autoForward:!!u.forward;if(!l)return;var p=h?Re(h,r,i):void 0;if("string"==typeof l)return;var y=De(l)?l(r,i.data,{data:p,src:c}):l;if(!y)return;var v=void 0;je(y)&&(y=p?y.withContext(p):y,v={autoForward:f}),this.spawn(y,d,v)}else this.spawnActivity(u);break;case et:this.stopChild(e.activity.id);break;case at:var g=e.label,m=e.value;g?this.logger(g,m):this.logger(m)}},e.prototype.removeChild=function(e){this.children.delete(e),this.forwardTo.delete(e),delete this.state.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),De(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,n){if(Le(e))return this.spawnPromise(Promise.resolve(e),t);if(De(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(t){return!1}}(i=e)&&"id"in i)return this.spawnActor(e);if(function(e){try{return"subscribe"in e&&De(e.subscribe)}catch(t){return!1}}(e))return this.spawnObservable(e,t);if(je(e))return this.spawnMachine(e,fe(fe({},n),{id:t}));if(null!==(r=e)&&"object"==typeof r&&"transition"in r&&"function"==typeof r.transition)return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'+t+'" of type "'+typeof e+'".');var r,i},e.prototype.spawnMachine=function(t,n){var r=this;void 0===n&&(n={});var i=new e(t,fe(fe({},this.options),{parent:this,id:n.id||t.id})),o=fe(fe({},fn),n);o.sync&&i.onTransition((function(e){r.send(dt,{state:e,id:i.id})}));var a=i;return this.children.set(i.id,a),o.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){r.removeChild(i.id),r.send(We(e,{origin:i.id}))})).start(),a},e.prototype.spawnBehavior=function(e,t){var n=ln(e,{id:t,parent:this});return this.children.set(t,n),n},e.prototype.spawnPromise=function(e,t){var n,r=this,i=!1;e.then((function(e){i||(n=e,r.removeChild(t),r.send(We(Kt(t,e),{origin:t})))}),(function(e){if(!i){r.removeChild(t);var n=Ot(t,e);try{r.send(We(n,{origin:t}))}catch(o){r.devTools&&r.devTools.send(n,r.state),r.machine.strict&&r.stop()}}}));var o={id:t,send:function(){},subscribe:function(t,n,r){var i=Ye(t,n,r),o=!1;return e.then((function(e){o||(i.next(e),o||i.complete())}),(function(e){o||i.error(e)})),{unsubscribe:function(){return o=!0}}},stop:function(){i=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return n}};return this.children.set(t,o),o},e.prototype.spawnCallback=function(e,t){var n,r,i=this,o=!1,a=new Set,s=new Set;try{r=e((function(e){n=e,s.forEach((function(t){return t(e)})),o||i.send(We(e,{origin:t}))}),(function(e){a.add(e)}))}catch(c){this.send(Ot(t,c))}if(Le(r))return this.spawnPromise(r,t);var u={id:t,send:function(e){return a.forEach((function(t){return t(e)}))},subscribe:function(e){return s.add(e),{unsubscribe:function(){s.delete(e)}}},stop:function(){o=!0,De(r)&&r()},toJSON:function(){return{id:t}},getSnapshot:function(){return n}};return this.children.set(t,u),u},e.prototype.spawnObservable=function(e,t){var n,r=this,i=e.subscribe((function(e){n=e,r.send(We(e,{origin:t}))}),(function(e){r.removeChild(t),r.send(We(Ot(t,e),{origin:t}))}),(function(){r.removeChild(t),r.send(We(Kt(t),{origin:t}))})),o={id:t,send:function(){},subscribe:function(t,n,r){return e.subscribe(t,n,r)},stop:function(){return i.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:t}}};return this.children.set(t,o),o},e.prototype.spawnActor=function(e){return this.children.set(e.id,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var n=t(this.state.context,e);this.spawnEffect(e.id,n)}},e.prototype.spawnEffect=function(e,t){this.children.set(e,{id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})},e.prototype.attachDev=function(){var e=un();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(fe(fe({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:fe({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}cn(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[Ue]=function(){return this},e.prototype.getSnapshot=function(){return this.status===dn.NotStarted?this.initialState:this._state},e.defaultOptions=function(e){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:(typeof self!=="undefined"?self:global).console.log.bind(console),devTools:!1}}(),e.interpret=vn,e}();function yn(e,t){var n=function(e){return He(e)?fe(fe({},fn),{name:e}):fe(fe(fe({},fn),{name:ze()}),e)}(t);return function(t){return t?t.spawn(e,n.name,n):zt(e,n.name)}(Vt[Vt.length-1])}function vn(e,t){return new pn(e,t)}var gn,mn,bn={raise:bt,send:_t,sendParent:kt,sendUpdate:function(){return kt(dt)},log:function(e,t){return void 0===e&&(e=Et),{type:at,label:t,expr:e}},cancel:St,start:xt,stop:wt,assign:Ct,after:It,done:Tt,respond:function(e,t){return _t(e,fe(fe({},t),{to:function(e,t,n){return n._event.origin}}))},forwardTo:function(e,t){return _t((function(e,t){return t}),fe(fe({},t),{to:e}))},escalate:function(e,t){return kt((function(t,n,r){return{type:lt,data:De(e)?e(t,n,r):e}}),fe(fe({},t),{to:qe.Parent}))},choose:function(e){return{type:Be.Choose,conds:e}},pure:function(e){return{type:Be.Pure,get:e}}};(mn=gn||(gn={}))[mn.Effect=1]="Effect",mn[mn.LayoutEffect=2]="LayoutEffect";var _n=d.exports.useLayoutEffect;function kn(e){var t=d.exports.useRef();return t.current||(t.current={v:e()}),t.current.v}function En(e,t){var n,r,i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}([[],[]],2),o=i[0],a=i[1];try{for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),u=s.next();!u.done;u=s.next()){var c=u.value;t(c)?o.push(c):a.push(c)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}var Sn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},xn=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Sn(arguments[t]));return e};function wn(e,t){(0,e.exec)(t.context,t._event.data,{action:e,state:t,_event:t._event})()}var Cn=function(){return(Cn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function In(e,t,n){void 0===t&&(t={});var r=kn((function(){return"function"==typeof e?e():e})),i=t.context,o=t.guards,a=t.actions,s=t.activities,u=t.services,c=t.delays,l=t.state,h=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["context","guards","actions","activities","services","delays","state"]),f=kn((function(){var e={context:i,guards:o,actions:a,activities:s,services:u,delays:c};return vn(r.withConfig(e,Cn(Cn({},r.context),i)),Cn({deferEvents:!0},h))}));return _n((function(){var e;return n&&(e=f.subscribe(function(e,t,n){if("object"==typeof e)return e;var r=function(){};return{next:e,error:t||r,complete:n||r}}(n))),function(){null==e||e.unsubscribe()}}),[n]),_n((function(){return f.start(l?Bt.create(l):void 0),function(){f.stop()}}),[]),_n((function(){Object.assign(f.machine.options.actions,a)}),[a]),_n((function(){Object.assign(f.machine.options.services,u)}),[u]),function(e){var t=d.exports.useRef([]),n=d.exports.useRef([]);_n((function(){var r=e.subscribe((function(e){var r,i;if(e.actions.length){var o=e.actions.filter((function(e){return"function"==typeof e.exec&&"__effect"in e.exec})),a=Sn(En(o,(function(e){return e.exec.__effect===gn.Effect})),2),s=a[0],u=a[1];(r=t.current).push.apply(r,xn(s.map((function(t){return[t,e]})))),(i=n.current).push.apply(i,xn(u.map((function(t){return[t,e]}))))}}));return function(){r.unsubscribe()}}),[]),_n((function(){for(;n.current.length;){var e=Sn(n.current.shift(),2);wn(e[0],e[1])}})),d.exports.useEffect((function(){for(;t.current.length;){var e=Sn(t.current.shift(),2);wn(e[0],e[1])}}))}(f),f}var Tn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};var Kn=function(){};function On(e,t){void 0===t&&(t=function(e){return function(e){return"state"in e}(e)?e.state:void 0});var n=d.exports.useRef(e),r=d.exports.useRef([]),i=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(d.exports.useState((function(){return t(e)})),2),o=i[0],a=i[1],s=kn((function(){return function(e){var t=n.current;(function(e){return"deferred"in e})(t)&&t.deferred?r.current.push(e):t.send(e)}}));return _n((function(){n.current=e,a(t(e));for(var i=e.subscribe({next:function(e){return a(e)},error:Kn,complete:Kn});r.current.length>0;){var o=r.current.shift();e.send(o)}return function(){i.unsubscribe()}}),[e]),[o,s]}function Pn(e){return 0!==("status"in e?e.status:e._status)?e.state:e.machine.initialState}function Rn(e){return[function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(On(e,Pn),1)[0],e.send]}var Ln={exports:{}};function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dn(e,t,n){return t&&Nn(e.prototype,t),n&&Nn(e,n),e}function Hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(){return(Fn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Hn(e,t,n[t])}))}return e}function jn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vn(e,t){return(Vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Gn(e,t,n){return(Gn=qn()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Vn(i,n.prototype),i}).apply(null,arguments)}function zn(e){var t="function"==typeof Map?new Map:void 0;return(zn=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Gn(e,arguments,Bn(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Vn(r,e)})(e)}function $n(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?Wn(e):t}function Xn(e,t,n){return(Xn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Qn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Yn(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return e.reduce((function(e,n){return e[n]=t||{value:n},e}),{})}var Zn={logLevel:"warn",defaultKeyEvent:"keydown",defaultComponent:"div",defaultTabIndex:"-1",ignoreTags:["input","select","textarea"],enableHardSequences:!1,ignoreKeymapAndHandlerChangesByDefault:!0,ignoreEventsCondition:function(e){var t=e.target;if(t&&t.tagName){var n=t.tagName.toLowerCase();return tr.option("_ignoreTagsDict")[n]||t.isContentEditable}return!1},ignoreRepeatedEventsWhenKeyHeldDown:!0,simulateMissingKeyPressEvents:!0,stopEventPropagationAfterHandling:!0,stopEventPropagationAfterIgnoring:!0,allowCombinationSubmatches:!1,customKeyCodes:{}},er=Un({},Zn);er._ignoreTagsDict=Yn(er.ignoreTags,!0);var tr=function(){function e(){Mn(this,e)}return Dn(e,null,[{key:"init",value:function(e){var t=this,n=e.ignoreTags,r=e.customKeyCodes;n&&(e._ignoreTagsDict=Yn(e.ignoreTags)),r&&(e._customKeyNamesDict=Yn(Object.values(e.customKeyCodes))),-1!==["verbose","debug","info"].indexOf(e.logLevel)&&console.warn("React HotKeys: You have requested log level '".concat(e.logLevel,"' but for performance reasons, logging below severity level 'warning' is disabled in production. Please use the development build for complete logs.")),Object.keys(e).forEach((function(n){t.set(n,e[n])}))}},{key:"set",value:function(e,t){er[e]=t}},{key:"reset",value:function(e){er[e]=Zn[e]}},{key:"option",value:function(e){return er[e]}}]),e}(),nr=function(){function e(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"warn";Mn(this,e),Hn(this,"verbose",this.noop),Hn(this,"debug",this.noop),Hn(this,"info",this.noop),Hn(this,"warn",this.noop),Hn(this,"error",this.noop),this.logLevel=this.constructor.levels[n],this.logLevel>=this.constructor.levels.error&&(this.error=console.error,this.logLevel>=this.constructor.levels.warn&&(this.warn=console.warn,["info","debug","verbose"].some((function(e){return!(t.logLevel>=t.constructor.levels[e]&&(t[e]=console.log,1))}))))}return Dn(e,[{key:"noop",value:function(){}}]),e}();Hn(nr,"logIcons",["","","",""]),Hn(nr,"componentIcons",["","","","",""]),Hn(nr,"eventIcons",["","","","","",""]),Hn(nr,"levels",{none:0,error:1,warn:2,info:3,debug:4,verbose:5});var rr={keydown:0,keypress:1,keyup:2},ir={Shift:["shiftKey"],Meta:["metaKey"],Control:["ctrlKey"],Alt:["altKey"]},or={"`":["~"],1:["!"],2:["@",'"'],3:["#",""],4:["$"],5:["%"],6:["^"],7:["&"],8:["*"],9:["("],0:[")"],"-":["_"],"=":["plus"],";":[":"],"'":['"',"@"],",":["<"],".":[">"],"/":["?"],"\\":["|"],"[":["{"],"]":["}"],"#":["~"]};function ar(e){return or[e]||[1===e.length?e.toUpperCase():e]}function sr(e,t){return e.hasOwnProperty(t)}function ur(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(n,r){var i=e[r];return i.forEach((function(e){sr(n,e)||(n[e]=[]),n[e].push(r)})),t.includeOriginal&&(!sr(n,r)&&(n[r]=[]),n[r]=[].concat(Qn(n[r]),Qn(i))),n}),{})}var cr=ur(or);function lr(e){return cr[e]||[1===e.length?e.toLowerCase():e]}var dr=ur({},{includeOriginal:!0});function hr(e){return"string"==typeof e}function fr(e){return hr(e)?e.trim().replace(/\s+/g," "):e}var pr={tab:"Tab",capslock:"CapsLock",shift:"Shift",meta:"Meta",alt:"Alt",ctrl:"Control",space:" ",spacebar:" ",escape:"Escape",esc:"Escape",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",return:"Enter",del:"Delete",command:"Meta",option:"Alt",enter:"Enter",backspace:"Backspace",ins:"Insert",pageup:"PageUp",pagedown:"PageDown",end:"End",home:"Home",contextmenu:"ContextMenu",numlock:"Clear"},yr={cmd:"Meta"};function vr(e){var t=e.toLowerCase();return pr[t]||yr[t]||(e.match(/^f\d+$/)?e.toUpperCase():e)}var gr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mr=Yn(Object.values(gr),!0);function br(e){return!!mr[e]}function _r(e){return br(e)||String.fromCharCode(e.charCodeAt(0))===e||function(e){return tr.option("_customKeyNamesDict")[e]}(e)}var kr=function(e){function t(){var e,n;Mn(this,t);for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return Hn(Wn(Wn(n=Jn(this,(e=Bn(t)).call.apply(e,[this].concat(i))))),"name","InvalidKeyNameError"),n}return jn(t,zn(Error)),t}();function Er(e){return e.sort().join("+")}var Sr=function(){function e(){Mn(this,e)}return Dn(e,null,[{key:"parse",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=fr(e),r=n.split(" ");try{var i=r.slice(0,r.length-1),o=r[r.length-1],a=i.map((function(e){var n=xr(e,t);return Er(Object.keys(n))})).join(" "),s=xr(o,t),u=Er(Object.keys(s)),c={id:u,keyDictionary:s,keyEventType:t.keyEventType,size:Object.keys(s).length};return{sequence:{prefix:a,size:i.length+1},combination:c}}catch(l){return{sequence:null,combination:null}}}}]),e}();function xr(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.replace(/^\+|(\s|[^+]\+)\+/,"$1plus").split("+").reduce((function(e,n){var r=vr(n);if(t.ensureValidKeys&&!_r(r))throw new kr;return e[r]=!0,e}),{})}var wr={"`":["`"],1:[""],2:[""],3:[""],4:[""],5:[""],6:[""],7:[""],8:[""],9:[""],0:[""],"-":[""],"=":[""],a:[""],b:[""],c:[""],d:[""],e:[""],f:[""],g:[""],h:[""],i:[""],j:[""],k:[""],l:[""],m:[""],n:[""],o:[""],p:[""],q:[""],r:[""],s:[""],t:[""],u:[""],v:[""],w:[""],x:[""],y:[""],z:[""],"[":[""],"]":[""],"\\":[""],"'":[""],";":[""],",":[""],".":[""],"/":[""]},Cr=ur(wr);function Ir(e){return Cr[e]||[e]}function Tr(e){return wr[e]||[e]}var Kr={"`":["`"],1:[""],2:[""],3:[""],4:[""],5:[""],6:[""],7:[""],8:[""],9:[""],0:[""],"-":[""],"=":[""],a:[""],b:[""],c:[""],d:[""],e:[""],f:[""],g:[""],h:[""],i:[""],j:[""],k:[""],l:[""],m:[""],n:[""],o:[""],p:[""],q:[""],r:[""],s:[""],t:[""],u:[""],v:[""],w:[""],x:[""],y:[""],z:[""],"[":[""],"]":[""],"\\":[""],"'":[""],";":[""],",":[""],".":[""]},Or=ur(Kr);function Pr(e){return Or[e]||lr(e)}function Rr(e){return Kr[e]||[e]}var Lr=function(){function e(){Mn(this,e)}return Dn(e,null,[{key:"serialize",value:function(e){var t=e.Shift,n=e.Alt,r={};return Object.keys(e).sort().forEach((function(e){var i=[];if(t)if(n){var o=Pr(e),a=Rr(e);i=[].concat(Qn(i),[e],Qn(o),Qn(a))}else{var s=lr(e),u=ar(e);i=[].concat(Qn(i),[e],Qn(s),Qn(u))}else if(n){var c=Ir(e),l=Tr(e);i=[].concat(Qn(i),[e],Qn(c),Qn(l))}else{i.push(e);var d=dr[e];d&&(i=[].concat(Qn(i),Qn(d)))}var h=Object.keys(r);0<h.length?h.forEach((function(e){i.forEach((function(t){r[e+"+".concat(t)]=Un({},r[e],Hn({},t,!0))})),delete r[e]})):i.forEach((function(e){r[e]=Hn({},e,!0)}))})),Object.values(r).map((function(e){return Object.keys(e).sort().join("+")}))}},{key:"isValidKeySerialization",value:function(e){return!!(0<e.length)&&!!Sr.parse(e,{ensureValidKeys:!0}).combination}}]),e}(),Ar=0,Mr=1;function Nr(e){return void 0===e}var Dr=0,Hr=1,Fr=2,Ur=function(){function e(){Mn(this,e)}return Dn(e,null,[{key:"newRecord",value:function(e,t){var n=[Dr,Dr,Dr];if(!Nr(e))for(var r=0;r<=e;r++)n[r]=t;return n}},{key:"setBit",value:function(e,t,n){return e[t]=n,e}},{key:"clone",value:function(e){for(var t=this.newRecord(),n=0;n<e.length;n++)t[n]=e[n];return t}}]),e}();function jr(e){return!Array.isArray(e)&&"object"===An(e)&&null!==e}function Br(e){return jr(e)?0===Object.keys(e).length:!e||0===e.length}function Vr(e){return jr(e)?Object.keys(e).length:e.length}var qr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Mn(this,e),this._keys=t,this._includesKeyUp=!1,this._update()}return Dn(e,[{key:"getIds",value:function(){return this._ids}},{key:"getKeyAliases",value:function(){return this._keyAliases}},{key:"getNormalizedKeyName",value:function(e){if(this._keys[e])return e;var t=this._keyAliases[e];return t||e}},{key:"getNumberOfKeys",value:function(){return Vr(this._keys)}},{key:"any",value:function(){return 0<Object.keys(this._getKeyStates()).length}},{key:"isEnding",value:function(){return this._includesKeyUp}},{key:"hasEnded",value:function(){return Br(this.keysStillPressedDict())}},{key:"addKey",value:function(e,t){this._setKeyState(e,[Ur.newRecord(),Ur.newRecord(rr.keydown,t)])}},{key:"setKeyState",value:function(e,t,n){var r=this._getKeyState(e);if(this.isKeyIncluded(e)){var i=Ur.clone(r[1]),o=Ur.clone(i);Ur.setBit(o,t,n),this._setKeyState(e,[i,o])}else this.addKey(e,n);t===rr.keyup&&(this._includesKeyUp=!0)}},{key:"forEachKey",value:function(e){return Object.keys(this._keys).forEach(e)}},{key:"some",value:function(e){return Object.keys(this._keys).some(e)}},{key:"getKeyDictionary",value:function(){return Yn(Object.keys(this._getKeyStates()),!0)}},{key:"keysStillPressedDict",value:function(){var e=this;return Object.keys(this._keys).reduce((function(t,n){return e.isKeyStillPressed(n)&&(t[n]=e._getKeyState(n)),t}),{})}},{key:"isKeyIncluded",value:function(e){return!!this._getKeyState(e)}},{key:"isKeyStillPressed",value:function(e){return this.isEventTriggered(e,rr.keypress)&&!this.isKeyReleased(e)}},{key:"isKeyReleased",value:function(e){return this.isEventTriggered(e,rr.keyup)}},{key:"isEventTriggered",value:function(e,t){return this._getKeyStateType(e,Mr,t)}},{key:"wasEventPreviouslyTriggered",value:function(e,t){return this._getKeyStateType(e,Ar,t)}},{key:"isKeyPressSimulated",value:function(e){return this._isKeyEventSimulated(e,rr.keypress)}},{key:"isKeyUpSimulated",value:function(e){return this._isKeyEventSimulated(e,rr.keyup)}},{key:"describe",value:function(){return this.getIds()[0]}},{key:"toJSON",value:function(){return{keys:this._getKeyStates(),ids:this.getIds(),keyAliases:this.getKeyAliases()}}},{key:"_getKeyStateType",value:function(e,t,n){var r=this._getKeyState(e);return r&&r[t][n]}},{key:"_update",value:function(){this._ids=Lr.serialize(this._keys),this._keyAliases=function(e){return Object.keys(e).reduce((function(t,n){return function(e){return dr[e]||[e]}(n).forEach((function(r){(function(e){if(e.Shift)return e.Alt?[Rr,Pr]:[ar,lr];if(e.Alt)return[Tr,Ir];var t=function(e){return[e]};return[t,t]})(e).forEach((function(e){e(r).forEach((function(e){(e!==n||n!==r)&&(t[e]=n)}))}))})),t}),{})}(this._keys)}},{key:"_isKeyEventSimulated",value:function(e,t){return this.isEventTriggered(e,t)===Fr}},{key:"_getKeyStates",value:function(){return this._keys}},{key:"_getKeyState",value:function(e){var t=this._keys[e];if(t)return t;var n=this._keyAliases[e];return n?this._keys[n]:void 0}},{key:"_setKeyState",value:function(e,t){var n=this.getNormalizedKeyName(e);this._keys[n]=t,this._update()}}]),e}();var Gr=function(){function e(t){var n=t.maxLength,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;Mn(this,e),this._records=[],this._maxLength=n,r?this._push(r):this._push(new qr)}return Dn(e,[{key:"getMostRecentCombinations",value:function(e){return this._records.slice(-e,-1)}},{key:"any",value:function(){return this._records.some((function(e){return e.any()}))}},{key:"getLength",value:function(){return this._records.length}},{key:"getCurrentCombination",value:function(){return this._records[this.getLength()-1]}},{key:"addKeyToCurrentCombination",value:function(e,t,n){this._ensureInitialKeyCombination(),this.getCurrentCombination().setKeyState(e,t,n)}},{key:"setMaxLength",value:function(e){this._maxLength=e,this._trimHistory()}},{key:"startNewKeyCombination",value:function(e,t){this._ensureInitialKeyCombination();var n=new qr(this.getCurrentCombination().keysStillPressedDict());n.addKey(e,t),this._push(n)}},{key:"toJSON",value:function(){return this._records.map((function(e){return e.toJSON()}))}},{key:"_ensureInitialKeyCombination",value:function(){0===this.getLength()&&this._push(new qr)}},{key:"_push",value:function(e){this._trimHistory(),this._records.push(e)}},{key:"_trimHistory",value:function(){for(;this.getLength()>this._maxLength;)this._shift()}},{key:"_shift",value:function(){this._records.shift()}}]),e}(),zr=function(){function e(){Mn(this,e),this._registry={}}return Dn(e,[{key:"get",value:function(e){return this._registry[e]}},{key:"set",value:function(e,t){this._registry[e]=t}},{key:"remove",value:function(e){delete this._registry[e]}},{key:"toJSON",value:function(){return this._registry}}]),e}();function $r(e){return Array.isArray(e)?e:e?[e]:[]}var Wr=function(e){function t(){return Mn(this,t),Jn(this,Bn(t).apply(this,arguments))}return jn(t,zr),Dn(t,[{key:"add",value:function(e,n){Xn(Bn(t.prototype),"set",this).call(this,e,{childIds:[],parentId:null,keyMap:n})}},{key:"update",value:function(e,n){var r=Xn(Bn(t.prototype),"get",this).call(this,e);Xn(Bn(t.prototype),"set",this).call(this,e,Un({},r,{keyMap:n}))}},{key:"setParent",value:function(e,t){this.get(e).parentId=t,this._addChildId(t,e)}},{key:"remove",value:function(e){var n=this._getParentId(e);this._removeChildId(n,e),Xn(Bn(t.prototype),"remove",this).call(this,e)}},{key:"_getParentId",value:function(e){var t=this.get(e);return t&&t.parentId}},{key:"_addChildId",value:function(e,t){this.get(e).childIds.push(t)}},{key:"_removeChildId",value:function(e,t){var n=this.get(e);n&&(n.childIds=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=Yn($r(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]));return Array.isArray(e)?e.reduce((function(e,r){return n[r]&&(t.stringifyFirst||n[r].value===r)||e.push(r),e}),[]):jr(e)?Object.keys(e).reduce((function(t,r){return n[r]||(t[r]=e[r]),t}),{}):e}(n.childIds,t))}}]),t}();var Jr=function(){function e(t){Mn(this,e),this._list=t,this._position=-1}return Dn(e,[{key:"getPosition",value:function(){return this._position}},{key:"getComponent",value:function(){return this._list.getAtPosition(this.getPosition())}},{key:"next",value:function(){return this.getPosition()+1<this._list.getLength()?(this._position++,this.getComponent()):null}}]),e}(),Xr=function(){function e(){Mn(this,e),this._list=[],this._idToIndex={},this._longestSequence=1,this._longestSequenceComponentId=null,this._keyMapEventRecord=Ur.newRecord()}return Dn(e,[{key:"getNewIterator",value:function(){return new Jr(this)}},{key:"add",value:function(e,t,n,r){if(this.containsId(e))return this.update(e,t,n,r);var i=this._build(e,t,n,r);this._list.push(i);var o=this._getLastIndex();return this._idToIndex[e]=o}},{key:"containsId",value:function(e){return!!this.get(e)}},{key:"get",value:function(e){return this.getAtPosition(this.getIndexById(e))}},{key:"getIndexById",value:function(e){return this._idToIndex[e]}},{key:"update",value:function(e,t,n,r){var i=this._isUpdatingComponentWithLongestSequence(e),o=this.getLongestSequence(),a=this._build(e,t,n,r);i&&a.sequenceLength!==o&&(a.sequenceLength>o?this._longestSequence=a.sequenceLength:this._recalculateLongestSequence()),this._list[this.getIndexById(e)]=a}},{key:"remove",value:function(e){var t=this._isUpdatingComponentWithLongestSequence(e);this.removeAtPosition(this.getIndexById(e)),t&&this._recalculateLongestSequence()}},{key:"any",value:function(){return 0!==this.getLength()}},{key:"isRoot",value:function(e){return this.getIndexById(e)>=this.getLength()-1}},{key:"getLongestSequence",value:function(){return this._longestSequence}},{key:"anyActionsForEventType",value:function(e){return!!this._keyMapEventRecord[e]}},{key:"getLength",value:function(){return this._list.length}},{key:"getAtPosition",value:function(e){return this._list[e]}},{key:"removeAtPosition",value:function(e){this._list=function(e,t){return[].concat(Qn(e.slice(0,t)),Qn(e.slice(t+1)))}(this._list,e);for(var t=e;t<this.getLength();)this._idToIndex[this.getAtPosition(t).componentId]=t,t++}},{key:"toJSON",value:function(){return this._list}},{key:"_getLastIndex",value:function(){return this.getLength()-1}},{key:"_build",value:function(e,t,n,r){var i=this._applyHardSequences(t,n),o=i.keyMap,a=i.handlers;return{actions:this._buildActionDictionary(Un({},t,o),r,e),handlers:a,componentId:e,options:r}}},{key:"_isUpdatingComponentWithLongestSequence",value:function(e){return e===this._getLongestSequenceComponentId()}},{key:"_getLongestSequenceComponentId",value:function(){return this._longestSequenceComponentId}},{key:"_recalculateLongestSequence",value:function(){for(var e=this.getNewIterator();e.next();){var t=e.getComponent(),n=t.longestSequence,r=t.componentId;n>this.getLongestSequence()&&(this._longestSequenceComponentId=r,this._longestSequence=n)}}},{key:"_applyHardSequences",value:function(e,t){return tr.option("enableHardSequences")?Object.keys(t).reduce((function(n,r){return!!!e[r]&&Lr.isValidKeySerialization(r)&&(n.keyMap[r]=r),n.handlers[r]=t[r],n}),{keyMap:{},handlers:{}}):{keyMap:e,handlers:t}}},{key:"_buildActionDictionary",value:function(e,t,n){var r=this;return Object.keys(e).reduce((function(i,o){var a=e[o];return(jr(a)&&sr(a,"sequences")?$r(a.sequences):$r(a)).forEach((function(e){var a=function(e,t){if(jr(e)){var n=e.sequence,r=e.action;return{keySequence:n,keyEventType:Nr(r)?rr[t.defaultKeyEvent]:rr[r]}}return{keySequence:e,keyEventType:rr[t.defaultKeyEvent]}}(e,t),s=a.keySequence,u=a.keyEventType;r._addActionOptions(i,n,o,s,u)})),i}),{})}},{key:"_addActionOptions",value:function(e,t,n,r,i){var o=Sr.parse(r,{keyEventType:i}),a=o.sequence,s=o.combination;a.size>this.getLongestSequence()&&(this._longestSequence=a.size,this._longestSequenceComponentId=t),this._keyMapEventRecord[i]=Hr,e[n]||(e[n]=[]),e[n].push(Un({prefix:a.prefix,actionName:n,sequenceLength:a.size},s))}}]),e}();function Qr(e,t){return e[e.length-(t+1)]}for(var Yr={Enter:!0,Backspace:!0,ArrowRight:!0,ArrowLeft:!0,ArrowUp:!0,ArrowDown:!0,CapsLock:!0},Zr=1;13>Zr;Zr++)Yr["F".concat(Zr)]=!0;function ei(e){return 1===e.length||sr(Yr,e)}var ti=function(){function e(){Mn(this,e),this._actionConfigs={},this._order=null}return Dn(e,[{key:"addMatch",value:function(e,t){if(this._includesMatcherForCombination(e.id)){var n=e.keyEventType,r=e.actionName,i=e.id;this._addHandlerToActionConfig(i,{keyEventType:n,actionName:r,handler:t})}else this._addNewActionConfig(e,t)}},{key:"findMatch",value:function(e,t,n){this._order||this._setOrder();var r=!0,i=!1,o=void 0;try{for(var a,s=this._order[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=this._actionConfigs[u];if(this._matchesActionConfig(e,t,n,c))return c}}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return null}},{key:"toJSON",value:function(){return{actionConfigs:this._actionConfigs,order:this._order}}},{key:"_matchesActionConfig",value:function(e,t,n,r){if(!function(e,t){var n=Vr(t.keyDictionary);return tr.option("allowCombinationSubmatches")||function(e){return!!e.isKeyStillPressed("Meta")&&e.some((function(e){return ei(e)}))}(e)?e.getNumberOfKeys()>=n:e.getNumberOfKeys()===n}(e,r))return!1;if(!r.events[n])return!1;var i=!1;return Object.keys(r.keyDictionary).every((function(r){return!!e.isEventTriggered(r,n)&&(t&&t===e.getNormalizedKeyName(r)&&(i=!e.wasEventPreviouslyTriggered(r,n)),!0)}))&&i}},{key:"_setOrder",value:function(){var e=Object.values(this._actionConfigs).reduce((function(e,t){var n=t.id,r=t.size;return e[r]||(e[r]=[]),e[r].push(n),e}),{});this._order=Object.keys(e).sort((function(e,t){return t-e})).reduce((function(t,n){return t.concat(e[n])}),[])}},{key:"_addNewActionConfig",value:function(e,t){var n=e.prefix,r=e.sequenceLength,i=e.id,o=e.keyDictionary,a=e.size,s=e.keyEventType,u=e.actionName;this._setCombinationMatcher(i,{prefix:n,sequenceLength:r,id:i,keyDictionary:o,size:a,events:{}}),this._addHandlerToActionConfig(i,{keyEventType:s,actionName:u,handler:t})}},{key:"_addHandlerToActionConfig",value:function(e,t){var n=t.keyEventType,r=t.actionName,i=t.handler,o=this._getCombinationMatcher(e);this._setCombinationMatcher(e,Un({},o,{events:Un({},o.events,Hn({},n,{actionName:r,handler:i}))}))}},{key:"_setCombinationMatcher",value:function(e,t){this._actionConfigs[e]=t}},{key:"_getCombinationMatcher",value:function(e){return this._actionConfigs[e]}},{key:"_includesMatcherForCombination",value:function(e){return!!this._getCombinationMatcher(e)}}]),e}();var ni=function(){function e(){Mn(this,e),this._combinationMatchers={},this._eventRecord=Ur.newRecord()}return Dn(e,[{key:"addMatch",value:function(e,t){this._getOrCreateCombinationMatcher(e.prefix).addMatch(e,t),Ur.setBit(this._eventRecord,e.keyEventType,Hr),(!this._longestSequence||this._longestSequence<e.sequenceLength)&&(this._longestSequence=e.sequenceLength)}},{key:"findMatch",value:function(e,t,n){var r=this._findCombinationMatcher(e);return r?r.findMatch(e.getCurrentCombination(),e.getCurrentCombination().getNormalizedKeyName(t),n):null}},{key:"hasMatchesForEventType",value:function(e){return!!this._eventRecord[e]}},{key:"getLongestSequence",value:function(){return this._longestSequence}},{key:"toJSON",value:function(){var e=this;return Object.keys(this._combinationMatchers).reduce((function(t,n){var r=e._combinationMatchers[n];return t[n]=r.toJSON(),t}),{})}},{key:"_getOrCreateCombinationMatcher",value:function(e){return this._combinationMatchers[e]||(this._combinationMatchers[e]=new ti),this._combinationMatchers[e]}},{key:"_findCombinationMatcher",value:function(e){var t=e.getMostRecentCombinations(this.getLongestSequence());if(0===t.length)return this._combinationMatchers[""];for(var n=t.map((function(e){return e.getIds()})),r=n.map((function(e){return e.length})),i=Array(n.length).fill(0),o=!1;!o;){var a=i.map((function(e,t){return n[t][e]})).join(" ");if(this._combinationMatchers[a])return this._combinationMatchers[a];for(var s=0,u=!0;u&&s<i.length;){var c=(Qr(i,s)+1)%(Qr(r,s)||1);i[i.length-(s+1)]=c,(u=0==c)&&s++}o=s===i.length}}}]),e}(),ri=function(){function e(t){Mn(this,e),this._keyMapMatchers=[],this._unmatchedHandlerStatus=[],this._handlersDictionary={},this._keySequencesDictionary={};for(var n=t.getNewIterator();n.next();){var r=n.getComponent().handlers;this._unmatchedHandlerStatus.push([Object.keys(r).length,{}]),this._keyMapMatchers.push(new ni)}this._componentList=t,this._componentListIterator=t.getNewIterator()}return Dn(e,[{key:"getKeyHistoryMatcher",value:function(e){if(this._componentHasUnmatchedHandlers(e))for(;this._componentListIterator.next();)this._addHandlersFromComponent(),this._addActionsFromComponent();return this._getKeyHistoryMatcher(e)}},{key:"componentHasActionsBoundToEventType",value:function(e,t){return this.getKeyHistoryMatcher(e).hasMatchesForEventType(t)}},{key:"findMatchingKeySequenceInComponent",value:function(e,t,n,r){return this.componentHasActionsBoundToEventType(e,r)?this.getKeyHistoryMatcher(e).findMatch(t,n,r):null}},{key:"_getKeyHistoryMatcher",value:function(e){return this._keyMapMatchers[e]}},{key:"_addActionsFromComponent",value:function(){var e=this,t=this._componentListIterator.getComponent().actions;Object.keys(t).forEach((function(n){var r=e._getHandlers(n);if(r){var i=r[0],o=e._componentList.getAtPosition(i).handlers[n],a=e._getKeyHistoryMatcher(i);t[n].forEach((function(t){var n=[t.prefix,t.id].join(" ");e._isClosestHandlerFound(n,t)||(a.addMatch(t,o),e._addKeySequence(n,[i,t.keyEventType]))})),r.forEach((function(t){var r=e._getUnmatchedHandlerStatus(t);r[1][n]||(r[1][n]=!0,r[0]--)}))}}))}},{key:"_getHandlers",value:function(e){return this._handlersDictionary[e]}},{key:"_addHandlersFromComponent",value:function(){var e=this,t=this._componentListIterator.getComponent().handlers;Object.keys(t).forEach((function(t){e._addHandler(t)}))}},{key:"_addHandler",value:function(e){this._handlersDictionary[e]||(this._handlersDictionary[e]=[]),this._handlersDictionary[e].push(this._componentListIterator.getPosition())}},{key:"_addKeySequence",value:function(e,t){this._keySequencesDictionary[e]||(this._keySequencesDictionary[e]=[]),this._keySequencesDictionary[e].push(t)}},{key:"_componentHasUnmatchedHandlers",value:function(e){return 0<this._getUnmatchedHandlerStatus(e)[0]}},{key:"_getUnmatchedHandlerStatus",value:function(e){return this._unmatchedHandlerStatus[e]}},{key:"_isClosestHandlerFound",value:function(e,t){return this._keySequencesDictionary[e]&&this._keySequencesDictionary[e].some((function(e){return e[1]===t.keyEventType}))}}]),e}();function ii(e,t,n){return n.forEach((function(n){sr(e,n)&&(t[n]=e[n])})),t}function oi(e){switch(parseInt(e,10)){case 0:return"keydown";case 1:return"keypress";default:return"keyup"}}function ai(e){return e.simulated?Fr:Hr}var si=["sequence","action"],ui=["name","description","group"],ci=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;Mn(this,e),this.logger=t.logger||new nr("warn"),this.componentId=-1,this.keyEventManager=n,this._componentTree=new Wr,this.rootComponentId=null,this._reset(),this.resetKeyHistory()}return Dn(e,[{key:"_reset",value:function(){this.componentList=new Xr,this._initHandlerResolutionState()}},{key:"_newKeyHistory",value:function(){return new Gr({maxLength:this.componentList.getLongestSequence()})}},{key:"getKeyHistory",value:function(){return this._keyHistory||(this._keyHistory=this._newKeyHistory()),this._keyHistory}},{key:"_initHandlerResolutionState",value:function(){this._actionResolver=null}},{key:"resetKeyHistory",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.keypressEventsToSimulate=[],this.keyupEventsToSimulate=[],this._keyHistory=this.getKeyHistory().any()&&!e.force?new Gr({maxLength:this.componentList.getLongestSequence()},new qr(this.getCurrentCombination().keysStillPressedDict())):this._newKeyHistory()}},{key:"getApplicationKeyMap",value:function(){return null===this.rootComponentId?{}:this._buildApplicationKeyMap([this.rootComponentId],{})}},{key:"_buildApplicationKeyMap",value:function(e,t){var n=this;return e.forEach((function(e){var r=n._componentTree.get(e),i=r.childIds,o=r.keyMap;o&&Object.keys(o).forEach((function(e){var r=o[e];t[e]={},jr(r)?sr(r,"sequences")?(ii(r,t[e],ui),t[e].sequences=n._createSequenceFromConfig(r.sequences)):(ii(r,t[e],ui),t[e].sequences=[ii(r,{},si)]):t[e].sequences=n._createSequenceFromConfig(r)})),n._buildApplicationKeyMap(i,t)})),t}},{key:"_createSequenceFromConfig",value:function(e){return $r(e).map((function(e){return jr(e)?ii(e,{},si):{sequence:e}}))}},{key:"registerKeyMap",value:function(e){return this.componentId+=1,this._componentTree.add(this.componentId,e),this.componentId}},{key:"reregisterKeyMap",value:function(e,t){this._componentTree.update(e,t)}},{key:"registerComponentMount",value:function(e,t){Nr(t)?this.rootComponentId=e:this._componentTree.setParent(e,t)}},{key:"deregisterKeyMap",value:function(e){this._componentTree.remove(e),e===this.rootComponentId&&(this.rootComponentId=null)}},{key:"_addComponent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;this.componentList.add(e,t,n,r),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence())}},{key:"_allKeysAreReleased",value:function(){return this.getCurrentCombination().hasEnded()}},{key:"getCurrentCombination",value:function(){return this.getKeyHistory().getCurrentCombination()}},{key:"_shouldSimulate",value:function(e,t){var n=function(e){return!br(e)}(t),r=this.getCurrentCombination();return e===rr.keypress?!n||n&&r.isKeyStillPressed("Meta"):e===rr.keyup&&ei(t)&&r.isKeyReleased("Meta")}},{key:"_cloneAndMergeEvent",value:function(e,t){return Un({},Object.keys(ir).reduce((function(t,n){return t[n]=e[n],t}),{}),t)}},{key:"_callClosestMatchingHandler",value:function(e,t,n,r,i){for(this._actionResolver||(this._actionResolver=new ri(this.componentList));i<=r;){this._actionResolver.getKeyHistoryMatcher(i);var o=this._actionResolver.findMatchingKeySequenceInComponent(i,this.getKeyHistory(),t,n);if(this.getCurrentCombination(),o){var a=o.events[n];return tr.option("allowCombinationSubmatches")&&Lr.serialize(o.keyDictionary),a.handler(e),this._stopEventPropagationAfterHandlingIfEnabled(e,i),!0}this._actionResolver.componentHasActionsBoundToEventType(i,n),i++}}},{key:"_stopEventPropagationAfterHandlingIfEnabled",value:function(e,t){return!!tr.option("stopEventPropagationAfterHandling")&&(this._stopEventPropagation(e,t),!0)}},{key:"_stopEventPropagation",value:function(){throw new Error("_stopEventPropagation must be overridden by a subclass")}},{key:"_checkForModifierFlagDiscrepancies",value:function(e,t,n){var r=this;Object.keys(ir).forEach((function(i){if(t!==i||n!==rr.keyup){var o=r.getCurrentCombination(),a=o.isKeyStillPressed(i);ir[i].forEach((function(t){!1===e[t]&&a&&o.setKeyState(i,rr.keyup,ai(e))}))}}))}},{key:"_logPrefix",value:function(){}}]),e}(),li=function(){function e(){Mn(this,e)}return Dn(e,null,[{key:"getId",value:function(){return Nr(this._id)&&(this._id=0),this._id}},{key:"incrementId",value:function(){this._id=this.getId()+1}}]),e}();var di={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"};function hi(e){var t,n,r=(t=tr.option("customKeyCodes"),n=e.keyCode||e.charCode,sr(t,n)?t[n]:e.nativeEvent?e.key:function(e){if(e.key){var t=di[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=function(e){var t,n=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===n&&(t=13):t=n,10===t&&(t=13),32<=t||13===t?t:0}(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?gr[e.keyCode]||"Unidentified":""}(e));return"+"===r?"plus":r}function fi(e){return"Meta"===e}var pi=0,yi=1,vi=2,gi=4,mi=function(){function e(t,n){var r=n.logger,i=n.logPrefix;Mn(this,e),this._componentList=t,this._previousPropagation=null,this.logger=r,this._logPrefix=i,this._reset()}return Dn(e,[{key:"_reset",value:function(){this._previousPosition=-1,this._position=-1,this._actionHandled=!1,this._ignoreEvent=!1,this._observeIgnoredEvents=!1,this._stopping=!1,this._componentId=null,this._key=null,this._type=null}},{key:"isFirstPropagationStep",value:function(){var e=this.getPreviousPosition();return-1===e||e>=this._position}},{key:"isForKey",value:function(e){return this._key===e}},{key:"isForEventType",value:function(e){return this._type===e}},{key:"startNewPropagationStep",value:function(e,t,n,r){return this._position=this._componentList.getIndexById(e),this._componentId=e,this.isFirstPropagationStep()&&(li.incrementId(),this._key=t.key,this._type=r),!(t.repeat&&tr.option("ignoreRepeatedEventsWhenKeyHeldDown")&&(this.ignoreEvent(t),1))}},{key:"finishPropagationStep",value:function(){this.isStopped()||this._componentList.isRoot(this._componentId)?(this._previousPropagation=this._clone(),this._reset()):this._previousPosition=this._position}},{key:"getPreviousPropagation",value:function(){return this._previousPropagation||(this._previousPropagation=this._clone({copyState:!1})),this._previousPropagation}},{key:"getPreviousPosition",value:function(){return this._previousPosition}},{key:"observeIgnoredEvents",value:function(){this._observeIgnoredEvents=!0}},{key:"ignoreEvent",value:function(e){return this.setIgnoreEvent(!0),!(!this.isIgnoringEvent()||!tr.option("stopEventPropagationAfterIgnoring")||(this.stop(e),this.finishPropagationStep(),0))}},{key:"setIgnoreEvent",value:function(e){this._ignoreEvent=e}},{key:"isIgnoringEvent",value:function(){return!this._observeIgnoredEvents&&this._ignoreEvent}},{key:"isStopped",value:function(){return this._stopping}},{key:"stop",value:function(e){return!this.isStopped()&&(this._stopping=!0,e.simulated||e.stopPropagation(),!0)}},{key:"isPendingPropagation",value:function(){var e=this.getPreviousPosition();return-1!==e&&e+1<this._position}},{key:"isHandled",value:function(){return this._actionHandled}},{key:"setHandled",value:function(){this._actionHandled=!0}},{key:"_clone",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.copyState,r=new e(this._componentList,{logger:this.logger,logPrefix:this._logPrefix});return(void 0===n||n)&&Object.assign(r,this),r}}]),e}(),bi=function(e){function t(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return Mn(this,t),(e=Jn(this,Bn(t).call(this,n,r))).focusTreeId=0,e}return jn(t,ci),Dn(t,[{key:"_reset",value:function(){Xn(Bn(t.prototype),"_reset",this).call(this),this.keypressEventsToSimulate=[],this.focusTreeId+=1,this.eventPropagator=new mi(this.componentList,{logger:this.logger,logPrefix:this._logPrefix.bind(this)})}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;if(this.resetOnNextFocus&&(this._reset(),this.resetOnNextFocus=!1),!this.componentList.containsId(e))return this._addComponent(e,t,n,r),this.focusTreeId}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0;e===this.focusTreeId&&this.componentList.containsId(t)&&(this.componentList.update(t,n,r,i),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._initHandlerResolutionState())}},{key:"disableHotKeys",value:function(e,t){return this.resetOnNextFocus||(this.resetOnNextFocus=!0),this.eventPropagator.isPendingPropagation()}},{key:"handleKeydown",value:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=hi(e);if(t!==this.focusTreeId)return this.eventPropagator.ignoreEvent(e),!0;var o=this.eventPropagator.startNewPropagationStep(n,e,i,rr.keydown);if(o){var a=this._howToHandleKeyEvent(e,t,n,i,r,rr.keydown);if(a===gi){var s=ai(e),u=this.getCurrentCombination();u.isKeyIncluded(i)||u.isEnding()?this._startAndLogNewKeyCombination(i,t,n,s):this._addToAndLogCurrentKeyCombination(i,rr.keydown,t,n,s),this._callHandlerIfActionNotHandled(e,i,rr.keydown,n,t)}return this._simulateKeyPressForNonPrintableKeys(e,i,t,n,r),this.eventPropagator.finishPropagationStep(),!1}}},{key:"_howToHandleKeyEvent",value:function(e,t,n,r,i,o){if(this.eventPropagator.isFirstPropagationStep()){if(i.ignoreEventsCondition(e)&&this.eventPropagator.ignoreEvent(e))return this._eventIsToBeIgnored(e,n,r,o);this._checkForModifierFlagDiscrepancies(e,r,o)}else if(this.eventPropagator.isIgnoringEvent())return this._eventIsToBeIgnored(e,n,r,o);return gi}},{key:"_eventIsToBeIgnored",value:function(e,t,n,r){return yi}},{key:"handleKeyPress",value:function(e,t,n,r){var i=hi(e),o=this.getCurrentCombination();if(o.isKeyPressSimulated(i))return this.eventPropagator.ignoreEvent(e),!0;if(this.eventPropagator.startNewPropagationStep(n,e,i,rr.keypress)){var a=t!==this.focusTreeId,s=this._howToHandleKeyEvent(e,t,n,i,r,rr.keypress);return this.eventPropagator.isFirstPropagationStep(n)&&o.isKeyIncluded(i)&&this._addToAndLogCurrentKeyCombination(i,rr.keypress,t,n,ai(e)),s===gi&&this._callHandlerIfActionNotHandled(e,i,rr.keypress,n,t),this.eventPropagator.finishPropagationStep(),a}}},{key:"handleKeyUp",value:function(e,t,n,r){var i=hi(e),o=this.getCurrentCombination();if(o.isKeyUpSimulated(i))return this.eventPropagator.ignoreEvent(e),!0;if(this.eventPropagator.startNewPropagationStep(n,e,i,rr.keyup)){var a=t!==this.focusTreeId,s=this._howToHandleKeyEvent(e,t,n,i,r,rr.keyup);return this.eventPropagator.isFirstPropagationStep(n)&&o.isKeyIncluded(i)&&this._addToAndLogCurrentKeyCombination(i,rr.keyup,t,n,ai(e)),s===gi&&this._callHandlerIfActionNotHandled(e,i,rr.keyup,n,t),this._simulateKeyUpEventsHiddenByCmd(e,i,t,n,r),this.eventPropagator.finishPropagationStep(),a}}},{key:"closeHangingKeyCombination",value:function(e,t){var n=this.getCurrentCombination();n.isKeyIncluded(e)&&!n.isEventTriggered(e,t)&&n.setKeyState(e,t,Fr)}},{key:"_simulateKeyPressForNonPrintableKeys",value:function(e,t,n,r,i){this._handleEventSimulation("keypressEventsToSimulate","simulatePendingKeyPressEvents",this._shouldSimulate(rr.keypress,t),{event:e,key:t,focusTreeId:n,componentId:r,options:i})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(e,t,n,r,i){var o=this;fi(t)&&this.getCurrentCombination().forEachKey((function(t){fi(t)||o._handleEventSimulation("keyupEventsToSimulate","simulatePendingKeyUpEvents",o._shouldSimulate(rr.keyup,t),{event:e,key:t,focusTreeId:n,componentId:r,options:i})}))}},{key:"_stopEventPropagation",value:function(e,t){this.eventPropagator.stop(e)}},{key:"getEventPropagator",value:function(){return this.eventPropagator}},{key:"_startAndLogNewKeyCombination",value:function(e,t,n,r){this.getKeyHistory().startNewKeyCombination(e,r)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t,n,r,i){this.getKeyHistory().addKeyToCurrentCombination(e,t,i)}},{key:"_handleEventSimulation",value:function(e,t,n,r){var i=r.event,o=r.key,a=r.focusTreeId,s=r.componentId,u=r.options;if(n&&tr.option("simulateMissingKeyPressEvents")){var c=this._cloneAndMergeEvent(i,{key:o,simulated:!0});this[e].push({event:c,focusTreeId:a,componentId:s,options:u})}(this.componentList.isRoot(s)||this.eventPropagator.isStopped())&&!this.keyEventManager.isGlobalListenersBound()&&this[t]()}},{key:"simulatePendingKeyPressEvents",value:function(){this._simulatePendingKeyEvents("keypressEventsToSimulate","handleKeyPress")}},{key:"simulatePendingKeyUpEvents",value:function(){this._simulatePendingKeyEvents("keyupEventsToSimulate","handleKeyUp")}},{key:"_simulatePendingKeyEvents",value:function(e,t){var n=this;0<this[e].length&&li.incrementId(),this[e].forEach((function(e){var r=e.event,i=e.focusTreeId,o=e.componentId,a=e.options;n[t](r,i,o,a)})),this[e]=[]}},{key:"_callHandlerIfActionNotHandled",value:function(e,t,n,r,i){if(this.getCurrentCombination().describe(),this.componentList.anyActionsForEventType(n))if(this.eventPropagator.isHandled());else{var o=this.eventPropagator.getPreviousPosition(),a=this.componentList.getIndexById(r);this._callClosestMatchingHandler(e,t,n,a,-1===o?0:o)&&this.eventPropagator.setHandled()}}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=nr.logIcons,r=nr.eventIcons,i=nr.componentIcons,o="HotKeys (";if(!1!==t.focusTreeId){var a=Nr(t.focusTreeId)?this.focusTreeId:t.focusTreeId;o+="F".concat(a).concat(n[a%n.length],"-")}if(!1!==t.eventId){var s=Nr(t.eventId)?li.getId():t.eventId;o+="E".concat(s).concat(r[s%r.length],"-")}o+="C".concat(e).concat(i[e%i.length]);var u=this.componentList.getIndexById(e);return Nr(u)||(o+="-P".concat(u).concat(i[u%i.length],":")),"".concat(o,")")}}]),t}();function _i(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)||hr(e)?n.stringifyFirst?!Nr(e.find((function(e){return e.toString()===t.toString()}))):-1!==e.indexOf(t):jr(e)?sr(e,t):n.stringifyFirst?e.toString()===t.toString():e===t}function ki(e){return e.replace(/\b\w/g,(function(e){return e.toUpperCase()}))}var Ei=function(e){function t(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;return Mn(this,t),(e=Jn(this,Bn(t).call(this,n,r))).listenersBound=!1,e.eventOptions={ignoreEventsCondition:tr.option("ignoreEventsCondition")},e.listeners={},e}return jn(t,ci),Dn(t,[{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i,this._addComponent(e,t,n,r),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"updateEnabledHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i,this.componentList.update(e,t,n,r),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"disableHotKeys",value:function(e){this.componentList.remove(e),this.getKeyHistory().setMaxLength(this.componentList.getLongestSequence()),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"_updateDocumentHandlers",value:function(){var e=this,t=this._listenersShouldBeBound();!this.listenersBound&&t?(Object.values(rr).forEach((function(t){var n=oi(t);document["on".concat(n)]=function(t){e.keyEventManager["handleGlobal".concat(function(e){return"".concat(ki(e.slice(0,3))).concat(ki(e.slice(3)))}(n))](t)}})),this.listenersBound=!0):this.listenersBound&&!t&&(Object.values(rr).forEach((function(e){var t=oi(e);delete document["on".concat(t)]})),this.listenersBound=!1)}},{key:"_listenersShouldBeBound",value:function(){return this.componentList.any()||this.listeners.keyCombination}},{key:"handleKeydown",value:function(e){var t=hi(e);if(e.repeat&&tr.option("ignoreRepeatedEventsWhenKeyHeldDown"))return!0;this._checkForModifierFlagDiscrepancies(e,t,rr.keydown);var n=this._howReactAppRespondedTo(e,t,rr.keydown);if(n!==pi||!this.eventOptions.ignoreEventsCondition(e)){if(n!==yi){var r=ai(e),i=this.getCurrentCombination();i.isKeyIncluded(t)||i.isEnding()?this._startAndLogNewKeyCombination(t,r):this._addToAndLogCurrentKeyCombination(t,rr.keydown,r)}_i([yi,gi],n)||this._callHandlerIfExists(e,t,rr.keydown),this._simulateKeyPressForNonPrintableKeys(e,t)}}},{key:"_howReactAppRespondedTo",value:function(e,t,n){var r=this.keyEventManager.reactAppHistoryWithEvent(t,n);return r===gi||r===yi||r===vi||li.incrementId(),r}},{key:"handleKeyPress",value:function(e){var t=hi(e);if(e.repeat&&tr.option("ignoreRepeatedEventsWhenKeyHeldDown"))return!0;var n=this.getCurrentCombination();if(n.isKeyPressSimulated(t))return!0;var r=this._howReactAppRespondedTo(e,t,rr.keypress);return n.isKeyIncluded(t)&&this._addToAndLogCurrentKeyCombination(t,rr.keypress,ai(e)),r===pi&&(this.keyEventManager.closeHangingKeyCombination(t,rr.keypress),this.eventOptions.ignoreEventsCondition(e))?void 0:void(!_i([yi,gi],r)&&this._callHandlerIfExists(e,t,rr.keypress))}},{key:"handleKeyUp",value:function(e){var t=hi(e),n=this.getCurrentCombination();if(n.isKeyUpSimulated(t))return!0;var r=this._howReactAppRespondedTo(e,t,rr.keyup);n.isKeyIncluded(t)&&this._addToAndLogCurrentKeyCombination(t,rr.keyup,ai(e)),r===pi?(this.keyEventManager.closeHangingKeyCombination(t,rr.keyup),this.eventOptions.ignoreEventsCondition(e)||!_i([yi,gi],r)&&this._callHandlerIfExists(e,t,rr.keyup)):!_i([yi,gi],r)&&this._callHandlerIfExists(e,t,rr.keyup),this._simulateKeyUpEventsHiddenByCmd(e,t),this.listeners.keyCombination&&this._allKeysAreReleased()&&this.listeners.keyCombination({keys:n.getKeyDictionary(),id:n.describe()})}},{key:"_simulateKeyPressForNonPrintableKeys",value:function(e,t){this.keyEventManager.simulatePendingKeyPressEvents(),this._handleEventSimulation("handleKeyPress",this._shouldSimulate(rr.keypress,t),{event:e,key:t})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(e,t){var n=this;fi(t)&&(this.keyEventManager.simulatePendingKeyUpEvents(),this.getCurrentCombination().forEachKey((function(t){fi(t)||n._handleEventSimulation("handleKeyUp",n._shouldSimulate(rr.keyup,t),{event:e,key:t})})))}},{key:"_startAndLogNewKeyCombination",value:function(e,t){this.getKeyHistory().startNewKeyCombination(e,t)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t,n){this.getKeyHistory().addKeyToCurrentCombination(e,t,n)}},{key:"_handleEventSimulation",value:function(e,t,n){var r=n.event,i=n.key;if(t&&tr.option("simulateMissingKeyPressEvents")){var o=this._cloneAndMergeEvent(r,{key:i,simulated:!0});this[e](o)}}},{key:"_callHandlerIfExists",value:function(e,t,n){return this.getCurrentCombination().describe(),this.componentList.anyActionsForEventType(n)?void this._callClosestMatchingHandler(e,t,n):void 0}},{key:"_callClosestMatchingHandler",value:function(e,n,r){for(var i=this.componentList.getNewIterator();i.next();)if(Xn(Bn(t.prototype),"_callClosestMatchingHandler",this).call(this,e,n,r,i.getPosition(),0))return}},{key:"_stopEventPropagation",value:function(e,t){e.simulated||e.stopPropagation()}},{key:"addKeyCombinationListener",value:function(e){var t=this,n=function(){delete t.listeners.keyCombination};return this.listeners.keyCombination=function(t){e(t),n()},this._updateDocumentHandlers(),n}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=nr.eventIcons,r=nr.componentIcons,i="HotKeys (GLOBAL";if(!1!==t.eventId){var o=Nr(t.eventId)?li.getId():t.eventId;i="".concat(i,"-E").concat(o).concat(n[o%n.length])}return Nr(e)?"".concat(i,"):"):"".concat(i,"-C").concat(e).concat(r[e%r.length],"):")}}]),t}();function Si(e){return!Nr(e)}var xi=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};Mn(this,e),this.logger=t.logger||new nr(tr.option("logLevel")),this._focusOnlyEventStrategy=new bi({configuration:t,logger:this.logger},this),this._globalEventStrategy=new Ei({configuration:t,logger:this.logger},this),this.mountedComponentsCount=0}return Dn(e,null,[{key:"getInstance",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.instance||(this.instance=new e(t)),this.instance}},{key:"clear",value:function(){delete this.instance}}]),Dn(e,[{key:"getApplicationKeyMap",value:function(){return Object.assign(this._globalEventStrategy.getApplicationKeyMap(),this._focusOnlyEventStrategy.getApplicationKeyMap())}},{key:"registerKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._focusOnlyEventStrategy.registerKeyMap(e)}},{key:"reregisterKeyMap",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this._focusOnlyEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterKeyMap",value:function(e){this._focusOnlyEventStrategy.deregisterKeyMap(e)}},{key:"registerComponentMount",value:function(e,t){return this._incrementComponentCount(),this._focusOnlyEventStrategy.registerComponentMount(e,t)}},{key:"registerComponentUnmount",value:function(){this._decrementComponentCount()}},{key:"_incrementComponentCount",value:function(){var e=this,t=this.mountedComponentsCount;this.mountedComponentsCount+=1,0===t&&1===this.mountedComponentsCount&&(window.onblur=function(){return e._clearKeyHistory()})}},{key:"_decrementComponentCount",value:function(){var e=this.mountedComponentsCount;this.mountedComponentsCount-=1,1===e&&0===this.mountedComponentsCount&&delete window.onblur}},{key:"_clearKeyHistory",value:function(){this._focusOnlyEventStrategy.resetKeyHistory({force:!0}),this._globalEventStrategy.resetKeyHistory({force:!0})}},{key:"registerGlobalKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._globalEventStrategy.registerKeyMap(e)}},{key:"registerGlobalComponentUnmount",value:function(){this._decrementComponentCount()}},{key:"registerGlobalComponentMount",value:function(e,t){return this._incrementComponentCount(),this._globalEventStrategy.registerComponentMount(e,t)}},{key:"reregisterGlobalKeyMap",value:function(e,t){this._globalEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterGlobalKeyMap",value:function(e){this._globalEventStrategy.deregisterKeyMap(e)}},{key:"addKeyCombinationListener",value:function(e){return this._globalEventStrategy.addKeyCombinationListener(e)}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0;return this._focusOnlyEventStrategy.enableHotKeys(e,t,n,r)}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0;return this._focusOnlyEventStrategy.updateEnabledHotKeys(e,t,n,r,i)}},{key:"disableHotKeys",value:function(e,t){return this._focusOnlyEventStrategy.disableHotKeys(e,t)}},{key:"handleKeydown",value:function(e,t,n,r){if(Si(t))return this._focusOnlyEventStrategy.handleKeydown(e,t,n,r)}},{key:"handleKeyPress",value:function(e,t,n,r){if(Si(t))return this._focusOnlyEventStrategy.handleKeyPress(e,t,n,r)}},{key:"handleKeyUp",value:function(e,t,n,r){if(Si(t))return this._focusOnlyEventStrategy.handleKeyUp(e,t,n,r)}},{key:"enableGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.enableHotKeys(e,t,n,r,i)}},{key:"updateEnabledGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.updateEnabledHotKeys(e,t,n,r,i)}},{key:"disableGlobalHotKeys",value:function(e){return this._globalEventStrategy.disableHotKeys(e)}},{key:"handleGlobalKeyDown",value:function(e){return this._globalEventStrategy.handleKeydown(e)}},{key:"handleGlobalKeyPress",value:function(e){return this._globalEventStrategy.handleKeyPress(e)}},{key:"handleGlobalKeyUp",value:function(e){return this._globalEventStrategy.handleKeyUp(e)}},{key:"ignoreEvent",value:function(e){this._focusOnlyEventStrategy.getEventPropagator().ignoreEvent(e)}},{key:"observeIgnoredEvents",value:function(e){this._focusOnlyEventStrategy.getEventPropagator().observeIgnoredEvents(e)}},{key:"closeHangingKeyCombination",value:function(e,t){this._focusOnlyEventStrategy.closeHangingKeyCombination(e,t)}},{key:"reactAppHistoryWithEvent",value:function(e,t){var n=this._focusOnlyEventStrategy.eventPropagator.getPreviousPropagation();return n.isForKey(e)&&n.isForEventType(t)?n.isHandled()?gi:n.isIgnoringEvent()?yi:vi:pi}},{key:"simulatePendingKeyPressEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyPressEvents()}},{key:"simulatePendingKeyUpEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyUpEvents()}},{key:"isGlobalListenersBound",value:function(){return this._globalEventStrategy.listenersBound}}]),e}();function wi(e,t){var n=t.deprecatedAPI,r=n.contextTypes,i=n.childContextTypes,o=t.newAPI.contextType;if(void 0===_.createContext)e.contextTypes=r,e.childContextTypes=i,e.prototype.getChildContext=function(){return this._childContext};else{var a=_.createContext(o);e.contextType=a,e.prototype._originalRender=e.prototype.render,e.prototype.render=function(){var e=this._originalRender();return e?_.createElement(a.Provider,{value:this._childContext},e):null}}return e}function Ci(e){function t(e,t){return Un({},i[e]||{},t[e]||{})}function n(e){return t("handlers",e)}function r(e){return t("keyMap",e)}var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=function(t){function i(e){var t;return Mn(this,i),(t=Jn(this,Bn(i).call(this,e)))._handleFocus=t._handleFocus.bind(Wn(Wn(t))),t._handleBlur=t._handleBlur.bind(Wn(Wn(t))),t._handleKeyDown=t._handleKeyDown.bind(Wn(Wn(t))),t._handleKeyPress=t._handleKeyPress.bind(Wn(Wn(t))),t._handleKeyUp=t._handleKeyUp.bind(Wn(Wn(t))),t._componentIsFocused=t._componentIsFocused.bind(Wn(Wn(t))),t._id=xi.getInstance().registerKeyMap(e.keyMap),t._childContext={hotKeysParentId:t._id},t}return jn(i,d.exports.PureComponent),Dn(i,[{key:"render",value:function(){var t=this.props;t.keyMap,t.handlers,t.allowChanges,t.root;var n=$n(t,["keyMap","handlers","allowChanges","root"]),r={onFocus:this._wrapFunction("onFocus",this._handleFocus),onBlur:this._wrapFunction("onBlur",this._handleBlur),tabIndex:tr.option("defaultTabIndex")};return this._shouldBindKeyListeners()&&(r.onKeyDown=this._handleKeyDown,r.onKeyPress=this._handleKeyPress,r.onKeyUp=this._handleKeyUp),_.createElement(e,Fn({hotKeys:r},n))}},{key:"_shouldBindKeyListeners",value:function(){var e=r(this.props);return!Br(e)||this.props.root||tr.option("enableHardSequences")&&this._handlersIncludeHardSequences(e,n(this.props))}},{key:"_handlersIncludeHardSequences",value:function(e,t){return Object.keys(t).some((function(t){return!e[t]&&Lr.isValidKeySerialization(t)}))}},{key:"_wrapFunction",value:function(e,t){var n=this;return"function"==typeof this.props[e]?function(r){n.props[e](r),t(r)}:t}},{key:"_focusTreeIdsPush",value:function(e){this._focusTreeIds||(this._focusTreeIds=[]),this._focusTreeIds.push(e)}},{key:"_focusTreeIdsShift",value:function(){this._focusTreeIds&&this._focusTreeIds.shift()}},{key:"_getFocusTreeId",value:function(){if(this._focusTreeIds)return this._focusTreeIds[0]}},{key:"componentDidUpdate",value:function(){var e=xi.getInstance();if(e.reregisterKeyMap(this._id,this.props.keyMap),this._componentIsFocused()&&(this.props.allowChanges||!tr.option("ignoreKeymapAndHandlerChangesByDefault"))){var t=this.props,n=t.keyMap,r=t.handlers;e.updateEnabledHotKeys(this._getFocusTreeId(),this._id,n,r,this._getComponentOptions())}}},{key:"_componentIsFocused",value:function(){return!0===this._focused}},{key:"componentDidMount",value:function(){var e=xi.getInstance(),t=this.context.hotKeysParentId;e.registerComponentMount(this._id,t)}},{key:"_handleFocus",value:function(){var e;this.props.onFocus&&(e=this.props).onFocus.apply(e,arguments);var t=xi.getInstance().enableHotKeys(this._id,r(this.props),n(this.props),this._getComponentOptions());Nr(t)||this._focusTreeIdsPush(t),this._focused=!0}},{key:"componentWillUnmount",value:function(){var e=xi.getInstance();e.deregisterKeyMap(this._id),e.registerComponentUnmount(),this._handleBlur()}},{key:"_handleBlur",value:function(){var e;this.props.onBlur&&(e=this.props).onBlur.apply(e,arguments);var t=xi.getInstance().disableHotKeys(this._getFocusTreeId(),this._id);t||this._focusTreeIdsShift(),this._focused=!1}},{key:"_handleKeyDown",value:function(e){xi.getInstance().handleKeydown(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyPress",value:function(e){xi.getInstance().handleKeyPress(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyUp",value:function(e){xi.getInstance().handleKeyUp(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:tr.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:tr.option("ignoreEventsCondition")}}}]),i}();return Hn(o,"propTypes",{keyMap:b.object,handlers:b.object,onFocus:b.func,onBlur:b.func,allowChanges:b.bool,root:b.bool}),wi(o,{deprecatedAPI:{contextTypes:{hotKeysParentId:b.number},childContextTypes:{hotKeysParentId:b.number}},newAPI:{contextType:{hotKeysParentId:void 0}}})}var Ii=Ci(function(e){function t(){return Mn(this,t),Jn(this,Bn(t).apply(this,arguments))}return jn(t,d.exports.Component),Dn(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=e.innerRef,r=e.component,i=$n(e,["hotKeys","innerRef","component"]),o=r||tr.option("defaultComponent");return _.createElement(o,Un({},t,{ref:n},i))}}]),t}());Ii.propTypes={innerRef:b.oneOfType([b.object,b.func])};var Ti=function(e){function t(e){var n;return Mn(this,t),(n=Jn(this,Bn(t).call(this,e)))._id=xi.getInstance().registerGlobalKeyMap(e.keyMap),n._childContext={globalHotKeysParentId:n._id},n}return jn(t,d.exports.Component),Dn(t,[{key:"render",value:function(){return this.props.children||null}},{key:"componentDidUpdate",value:function(){var e=xi.getInstance();if(e.reregisterGlobalKeyMap(this._id,this.props.keyMap),this.props.allowChanges||!tr.option("ignoreKeymapAndHandlerChangesByDefault")){var t=this.props,n=t.keyMap,r=t.handlers;e.updateEnabledGlobalHotKeys(this._id,n,r,this._getComponentOptions(),this._getEventOptions())}}},{key:"componentDidMount",value:function(){var e=this.props,t=e.keyMap,n=e.handlers,r=this.context.globalHotKeysParentId,i=xi.getInstance();i.registerGlobalComponentMount(this._id,r),i.enableGlobalHotKeys(this._id,t,n,this._getComponentOptions(),this._getEventOptions())}},{key:"componentWillUnmount",value:function(){var e=xi.getInstance();e.deregisterGlobalKeyMap(this._id),e.disableGlobalHotKeys(this._id),e.registerGlobalComponentUnmount()}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:tr.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:tr.option("ignoreEventsCondition")}}}]),t}();Hn(Ti,"propTypes",{keyMap:b.object,handlers:b.object,allowChanges:b.bool});var Ki=wi(Ti,{deprecatedAPI:{contextTypes:{globalHotKeysParentId:b.number},childContextTypes:{globalHotKeysParentId:b.number}},newAPI:{contextType:{globalHotKeysParentId:void 0}}});function Oi(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]},i=2<arguments.length?arguments[2]:void 0;return n=t=function(t){function n(e){var t;return Mn(this,n),(t=Jn(this,Bn(n).call(this,e)))._handleKeyEvent=t._handleKeyEvent.bind(Wn(Wn(t))),t._reloadDictionaries=t._reloadDictionaries.bind(Wn(Wn(t))),t}return jn(n,d.exports.PureComponent),Dn(n,[{key:"render",value:function(){var t=this.props;t.only,t.except;var n=$n(t,["only","except"]),r={onKeyDown:this._handleKeyEvent,onKeyPress:this._handleKeyEvent,onKeyUp:this._handleKeyEvent,onFocus:this._reloadDictionaries};return _.createElement(e,Fn({hotKeys:r},n))}},{key:"_reloadDictionaries",value:function(){var e=this.props,t=e.only,n=e.except;this._onlyDict=Pi(t),this._exceptDict=Pi(n)}},{key:"_shouldIgnoreEvent",value:function(e){var t=e.key;return Br(this._onlyDict)?!!Br(this._exceptDict)||!sr(this._exceptDict,t):Br(this._exceptDict)?sr(this._onlyDict,t):sr(this._onlyDict,t)&&!sr(this._exceptDict,t)}},{key:"_handleKeyEvent",value:function(e){this._shouldIgnoreEvent(e)&&xi.getInstance()[i](e)}}]),n}(),Hn(t,"propTypes",{only:b.oneOfType([b.string,b.arrayOf(b.string)]),except:b.oneOfType([b.string,b.arrayOf(b.string)])}),Hn(t,"defaultProps",r),n}function Pi(e){return $r(e).reduce((function(e,t){var n=vr(t);if(!_r(n))throw new kr(t);return[Rr,Pr,ar,lr,Tr,Ir].forEach((function(t){e[t(n)]=!0})),e}),{})}var Ri=Oi(function(e){function t(){return Mn(this,t),Jn(this,Bn(t).apply(this,arguments))}return jn(t,d.exports.Component),Dn(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=$n(e,["hotKeys"]),r=n.component||tr.option("defaultComponent");return _.createElement(r,Un({},t,n))}}]),t}(),{},"ignoreEvent"),Li=Oi(function(e){function t(){return Mn(this,t),Jn(this,Bn(t).apply(this,arguments))}return jn(t,d.exports.Component),Dn(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=$n(e,["hotKeys"]),r=n.component||tr.option("defaultComponent");return _.createElement(r,Un({},t,n))}}]),t}(),{},"observeIgnoredEvents");var Ai=k(Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",HotKeys:Ii,GlobalHotKeys:Ki,IgnoreKeys:Ri,ObserveKeys:Li,withHotKeys:Ci,withIgnoreKeys:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]};return Oi(e,t,"ignoreEvent")},withObserveKeys:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]};return Oi(e,t,"observeIgnoredEvents")},configure:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};tr.init(e)},getApplicationKeyMap:function(){return xi.getInstance().getApplicationKeyMap()},recordKeyCombination:function(e){return xi.getInstance().addKeyCombinationListener(e)}}));Ln.exports=Ai;const Mi=H.div`
  background-color: transparent;
  border: none;
  padding: 0.27rem 0.5rem 0.5rem 0;
  color: ${({theme:e})=>e.brand};
  height: 1rem;
  border: none;
  font-weight: bold;
`,Ni=y(H.div`
  box-sizing: border-box;
  border-radius: 3px;
  background-color: ${({theme:e})=>e.backgroundDarker};
  box-shadow: 0 2px 25px 0 ${({theme:e})=>e.darkShadow};
  color: ${({theme:e})=>e.fontDark};
  border-radius: 2px;
  padding: 0.5rem;
  line-height: 1rem;
  margin-top: 2.5rem;
  font-weight: bold;
  position: fixed;
  width: auto;
  z-index: 802;
`),Di=H.div`
  color: ${({theme:e})=>e.font};
  display: flex;
  padding-bottom: 0.5rem;
`,Hi=_.memo((({barRef:e,followRef:t,serviceRef:n,style:r,machine:i})=>{const o=d.exports.useContext(F);let a,c;[a,c]=i||Rn(n);const l=d.exports.useRef(),[y,v]=d.exports.useState(null),{error:g,errorId:m}=a.context,[b,_]=h((()=>{const e=t?{left:t.current.getBoundingClientRect().x,top:t.current.getBoundingClientRect().y}:{};return u(s({},e),{opacity:m?1:0,from:{opacity:0},config:E.stiff})}));return d.exports.useEffect((()=>{y&&clearTimeout(y),!m&&v(setTimeout((()=>c("CLEAR_ERROR")),1e3)),_({opacity:m?1:0})}),[m]),q(l,(()=>c("CLEAR_ERROR_ID"))),G(e,t,_),p(Ni,{ref:l,style:s(u(s({},b),{display:g?"block":"none"}),r),children:g?f(S,{children:[f(Di,{children:[p(x,{style:{color:o.error,marginRight:"0.5rem"}}),p("div",{style:{marginTop:"0.25rem"},children:`Invalid ${g.name}.`})]}),g.error]}):null})})),Fi=y(H.div`
  cursor: pointer;
  margin: 0.25rem 0.25rem;
  padding: 0.1rem 0.25rem;
  font-weight: bold;
  color: ${({theme:e})=>e.fontDark};
`),Ui=_.memo((({result:e,isActive:t,send:n,highlight:r})=>{const i=d.exports.useRef(null),o=d.exports.useContext(F),[a,s]=h((()=>({backgroundColor:t?o.backgroundLight:o.backgroundDark,color:t?o.font:o.fontDark})));d.exports.useEffect((()=>{s({backgroundColor:t?o.backgroundLight:o.backgroundDark,color:t?o.font:o.fontDark}),t&&i.current&&i.current.scrollIntoView()}),[t,i.current]);return p(Fi,{ref:i,onClick:e=>n({type:"COMMIT",value:e.target.dataset.result,click:!0}),onMouseEnter:()=>s({backgroundColor:o.backgroundLight,color:o.font}),onMouseLeave:()=>!t&&s({backgroundColor:o.backgroundDark,color:o.fontDark}),style:a,"data-result":e,children:[null,void 0].includes(e)?p("code",{style:{color:r},children:"None"}):e})})),ji=y(H.div`
  background-color: ${({theme:e})=>e.backgroundDark};
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  border-radius: 2px;
  box-shadow: 0 2px 20px ${({theme:e})=>e.backgroundDark};
  box-sizing: border-box;
  margin-top: 2.5rem;
  position: fixed;
  width: auto;
  z-index: 801;
  max-height: 328px;
  overflow-y: scroll;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`),Bi=_.memo((e=>{var t=e,{results:n,send:r,currentResult:i,barRef:o,followRef:a,bestMatch:l,highlight:d}=t,f=c(t,["results","send","currentResult","barRef","followRef","bestMatch","highlight"]);const[y,v]=h((()=>{const e=a?{left:a.current.getBoundingClientRect().x,top:a.current.getBoundingClientRect().y}:{};return u(s({},e),{opacity:1,from:{opacity:0},config:E.stiff})}));return G(o,a,v),n.length?p(ji,u(s({style:y,onMouseEnter:()=>r("MOUSEENTER"),onMouseLeave:()=>r("MOUSELEAVE")},f),{children:n.map(((e,t)=>p(Ui,{result:e,isActive:i===t||l===e,send:r,highlight:d},e)))})):null})),Vi=(e,t)=>{t=t||"";const n=e.filter((e=>e.toLowerCase().startsWith(t.toLowerCase())))[0];return n&&t.length?{placeholder:n.slice(t.length),value:n}:{placeholder:"",value:null}},qi=(e,t)=>{const n=e.filter((e=>e.toLowerCase()===t.toLowerCase()));return 1===n.length?n[0]:null},{assign:Gi}=bn,zi=e=>"string"!=typeof e?String(e):e,$i=e=>e.includes("|")?["Union[",e.split("|").map((e=>$i(e))).join(", "),"]"].join(""):"list<str>"===e?"List[str]":"list<id>"===e?"List[id]":e,Wi={bool:{castFrom:e=>e?"True":"False",castTo:e=>0===["true","false"].indexOf(e.toLowerCase()),parse:e=>e.toLowerCase().charAt(0).toUpperCase()+e.toLowerCase().slice(1),validate:e=>["true","false"].indexOf(zi(e).toLowerCase())>=0},float:{castFrom:e=>String(e),castTo:e=>+e,parse:e=>{const t=e.replace(/[\s]/g,""),[n,r]=t.split(".");return n.replace(/\B(?=(\d{3})+(?!\d))/g,",")+(r?"."+r:"")},validate:e=>{const t=zi(e).replace(/[\s]/g,"");return""!==t&&!isNaN(+t)}},field:{castFrom:e=>e,castTo:e=>e,parse:(e,t)=>t.filter((t=>t.toLowerCase()===e.toLowerCase()))[0],validate:(e,t)=>"string"==typeof e&&t.includes(e.toLowerCase())},dict:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return("string"==typeof e?JSON.parse(e):e)instanceof Object&&!Array.isArray(e)}catch{return!1}}},id:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>/[0-9A-Fa-f]{24}/g.test(e)},int:{castFrom:e=>String(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),castTo:e=>+e.replace(/[,\s]/g,""),parse:e=>String(+e.replace(/[,\s]/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,","),validate:e=>/^\d+$/.test(zi(e).replace(/[,\s]/g,""))},json:{castFrom:e=>JSON.stringify(e,null,2),castTo:e=>"string"==typeof e?JSON.parse(e):e,parse:e=>e,validate:e=>{try{return JSON.parse(e),!0}catch{return!1}}},"list<field>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:(e,t)=>{const n=e.replace(/[\s]/g,"");let r=null;try{r=JSON.parse(n)}catch{r=n.split(",")}return Array.isArray(r)&&r.every((e=>Wi.field.validate(e,t)))}},"list<id>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>Wi.id.validate(e)))}},"list<str>":{castFrom:e=>e.join(","),castTo:e=>e.split(","),parse:e=>e.replace(/[\s\'\"\[\]]/g,""),validate:e=>{const t=e.replace(/[\s]/g,"");let n=null;try{n=JSON.parse(t)}catch{n=t.split(",")}return Array.isArray(n)&&n.every((e=>Wi.str.validate(e)))}},NoneType:{castFrom:e=>null===e?"None":e,castTo:()=>null,parse:()=>"None",validate:e=>[null,"None",""].some((t=>e===t))},str:{castFrom:e=>e,castTo:e=>e,parse:e=>e,validate:e=>{if("string"!=typeof e)return!1;try{return JSON.parse(e),!1}catch{return!0}}}};var Ji=Yt({id:"viewStageParameter",initial:"decide",context:{id:void 0,defaultValue:void 0,parameter:void 0,stage:void 0,type:void 0,value:"",submitted:void 0,tail:void 0,focusOnInit:void 0,error:void 0,fieldNames:[]},states:{decide:{always:[{target:"editing",cond:e=>e.focusOnInit},{target:"reading.submitted",cond:e=>e.submitted},{target:"reading.pending"}]},reading:{initial:"pending",entry:"blurInput",states:{pending:{},submitted:{}},on:{EDIT:"editing"}},editing:{entry:[kt("PARAMETER.EDIT"),Gi({bestMatch:({fieldNames:e,value:t,type:n})=>"field"===n?Vi(e,t):{},currentResult:null,prevValue:({value:e})=>e,focusOnInit:!1,results:({type:e,fieldNames:t,value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]}),"focusInput"],initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}},on:{CHANGE:{actions:[Gi({bestMatch:({fieldNames:e,type:t},{value:n})=>"field"===t?Vi(e,n):{},currentResult:null,value:(e,{value:t})=>t,errorId:void 0,results:({type:e,fieldNames:t},{value:n})=>"field"===e?t.filter((e=>e.toLowerCase().startsWith(n.toLowerCase()))):[]})]},COMMIT:[{target:"decide",actions:[Gi({submitted:!0,value:({type:e,value:t,defaultValue:n,fieldNames:r,bestMatch:i},{value:o})=>{const a="field"===e?qi(r,t):null;return t=o||t,""===(t=a||(i.value?i.value:t))&&n?n:e.split("|").reduce(((e,n)=>{if(void 0!==e)return e;const i=Wi[n];return i.validate(t,r)?i.parse(t,r):e}),void 0)},errorId:void 0,bestMatch:{}}),"blurInput",kt((e=>({type:"PARAMETER.COMMIT",parameter:e})))],cond:({type:e,fieldNames:t,value:n,defaultValue:r,bestMatch:i},{value:o})=>{n=o||n;const a="field"===e?qi(t,n):null;return""===(n=a||(i.value?i.value:n))&&r||e.split("|").some((e=>Wi[e].validate(n,t)))}},{actions:[Gi({error:({type:e})=>({name:"value",error:`Expected type "${$i(e)}"`}),errorId:z()})]}],CANCEL:{target:"reading.pending",actions:[Gi({value:({prevValue:e})=>e,errorId:void 0})]},NEXT_RESULT:{actions:Gi({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),value:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:Gi({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,value:({currentResult:e,prevValue:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})}}}},on:{BLUR:[{target:"reading.pending",cond:({submitted:e,prevValue:t})=>!e&&""!==t,actions:[Gi({value:({prevValue:e})=>e})]},{target:"reading.submitted",cond:({submitted:e})=>e}],FOCUS:{actions:"focusInput"},CLEAR_ERROR:{actions:[Gi({error:void 0})]},CLEAR_ERROR_ID:{actions:[Gi({errorId:void 0})]},UPDATE:{actions:Gi({active:(e,{active:t})=>t})}}},{actions:{blurInput:()=>{},focusInput:()=>{}}});const Xi=H.div`
  display: flex;
  overflow: visible;
  z-index: 800;
`,Qi=y(H.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  display: flex;
  overflow: visible;
  height: 100%;
`),Yi=y(H(w)`
  & > input {
    background-color: transparent;
    border: none;
    padding: 0.5rem 0 0.5rem 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    font-weight: bold;
  }

  & > input:focus {
    border: none;
    outline: none;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
  }
`),Zi=y(H.div`
  font-weight: bold;
  position: fixed;
  line-height: 1rem;
  font-size: 14px;
  margin-left: -1px;
  overflow: visible;
  display: flex;
  border: 1px solid pink;
  border-style: solid;
  z-index: 800;
  will-change: transform;
  min-width: 2rem;
`),eo=y(H.textarea`
  background-color: transparent;
  overflow: visible;
  line-height: 1rem;
  border: none;
  color: ${({theme:e})=>e.font};
  height: 100%;
  font-size: 14px;
  will-change: tranform;
  resize: none;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }

  &:focus {
    border: none;
    outline: none;
  }
`),to=y(H.button`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  color: ${({theme:e})=>e.font};
  background-color: ${({theme:e})=>e.backgroundLight};
  border-radius: 3px;
  position: relative;
  line-height: 1rem;
  cursor: pointer;
  font-weight: bold;
  position: absolute;
  bottom: 0.5rem;
  right: 0.5rem;

  :focus {
    outline: none;
  }
`),no=_.memo((({send:e})=>{const t=h({opacity:1,from:{opacity:0}});return p(to,{style:t,onClick:()=>e("COMMIT"),children:"Submit"})})),ro=(e,t)=>Wi.dict.validate(e)?"  . . .  ":""===e?t:e,io=({placeholder:e,parameter:t})=>void 0!==e?e:t;let oo;const ao=({barRef:e,parameterRef:t,followRef:n,inputRef:r,stageRef:i,onClose:o,hasExpansion:a})=>{const[u,c]=Rn(t),[l]=Rn(i),v=d.exports.useContext(F),g=d.exports.useRef(null),{active:m,value:b}=u.context,[_,k]=h((()=>({height:u.matches("editing")?200:36,position:u.matches("editing")?"fixed":"relative",backgroundColor:u.matches("editing")?v.backgroundDark:u.matches("reading.submitted")?v.backgroundLight:v.background,borderColor:m&&l.matches("focusedViewBar.yes")?v.brand:v.fontDarkest,opacity:1,from:{opacity:0}}))),E=h({width:u.matches("editing")?400:0});q(g,(e=>{c("BLUR"),o()})),d.exports.useEffect((()=>{k({position:u.matches("editing")?"fixed":"relative",backgroundColor:u.matches("editing")?v.backgroundDark:u.matches("reading.submitted")?v.backgroundLight:v.background,borderColor:m&&l.matches("focusedViewBar.yes")?v.brand:v.fontDarkest,height:u.matches("editing")?200:36,opacity:1})}),[u.matches("editing"),m,l.matches("focusedViewBar.yes")]);const x=()=>{oo&&window.cancelAnimationFrame(oo),oo=window.requestAnimationFrame((()=>{const{x:t,y:r}=u.matches("editing")?n.current.getBoundingClientRect():{x:0,y:0};g.current.style.top=u.matches("editing")?`${r}px`:"unset",g.current.style.left=u.matches("editing")?`${t}px`:"unset";const{x:i,width:o}=e.current.getBoundingClientRect(),a=i+o;g.current.style.width=u.matches("editing")?`${Math.min(a-t,400)}px`:"auto"}))};return $(e.current?e.current:null,"scroll",x),$(window,"scroll",x),W(g?g.current:null,x),f(S,{children:[u.matches("editing")&&p(y.div,{style:s({height:"100%"},E)}),f(Zi,{style:_,onClick:()=>u.matches("reading")&&c("EDIT"),ref:g,children:[u.matches("reading")?p("div",{style:{padding:"0.5em",whiteSpace:"nowrap"},children:ro(b,io(u.context))}):f(S,{children:[p(eo,{autoFocus:u.matches("editing"),style:E,onChange:e=>{c({type:"CHANGE",value:e.target.value.replace(/&#13/g,"\n")})},onKeyDown:e=>{["Escape","Tab"].includes(e.key)&&(c("COMMIT"),o())},value:b,ref:r},"textarea"),a&&p(I,{style:{cursor:"pointer",color:v.font,marginTop:"0.2em",position:"absolute",right:"0.2rem"},onClick:o}),p(no,{send:c},"submit")]}),p(Hi,{serviceRef:t,style:{marginTop:"12.5rem",marginLeft:0}},"error")]})]})},so=_.memo((({parameterRef:e,barRef:t,stageRef:n})=>{const r=d.exports.useContext(F),[i,o]=Rn(e),[a]=Rn(n),s=d.exports.useRef(),[u,c]=d.exports.useState({}),[l,y]=d.exports.useState(!1),{type:v,value:g,active:m,currentResult:b,results:_,bestMatch:k}=i.context,E=v.split("|").some((e=>["dict","json"].includes(e))),x="dict|str"===v,w=E&&(!x||l);let I=!1;try{const e=JSON.parse(g);I=!Array.isArray(e)&&"object"==typeof e}catch{}d.exports.useEffect((()=>{x&&!l&&I&&y(!0)}),[g]);const T=h({backgroundColor:i.matches("editing")?r.backgroundDark:i.matches("reading.submitted")?r.backgroundLight:r.background,borderStyle:"solid",borderColor:m&&a.matches("focusedViewBar.yes")?r.brand:r.fontDarkest,height:w&&i.matches("editing")?200:36,borderWidth:w?0:1,borderRightWidth:0,opacity:1,from:{opacity:0}}),K=i.matches("editing");return d.exports.useEffect((()=>{K&&s.current&&s.current.focus(),!K&&s.current&&s.current.blur()}),[K,s.current]),f(S,{children:[p(Xi,{ref:e=>e&&e!==u.current&&c({current:e}),children:w?p(ao,{parameterRef:e,barRef:t,followRef:u,inputRef:s,stageRef:n,onClose:()=>{x&&(y(!1),I&&o("BLUR"))},hasExpansion:x}):f(Qi,{style:T,children:[p(Yi,{placeholder:io(i.context),autoFocus:i.matches("editing"),value:I?". . .":i.matches("reading")&&g.length>24?g.slice(0,25)+"...":g,onFocus:()=>!K&&o({type:"EDIT"}),onBlur:()=>i.matches("editing.notHovering")&&o({type:"COMMIT"}),onChange:e=>{o({type:"CHANGE",value:e.target.value})},onKeyPress:e=>{"Enter"===e.key&&K&&o({type:"COMMIT"})},onKeyDown:e=>{switch(e.key){case"Tab":o("COMMIT");case"Escape":o("COMMIT");break;case"ArrowDown":o("NEXT_RESULT");break;case"ArrowUp":o("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&k.value&&o({type:"CHANGE",value:k.value})}},ref:s}),p(Mi,{children:k?k.placeholder:""}),x&&K&&p(C,{style:{cursor:"pointer",color:r.font,marginTop:"0.2em"},onMouseEnter:()=>o("MOUSEENTER"),onMouseLeave:()=>o("MOUSELEAVE"),onClick:()=>y(!0)})]})}),i.matches("editing")&&t.current&&u.current&&p(Bi,{results:_,send:o,currentResult:b,bestMatch:k.value,followRef:u,barRef:t}),!E&&u.current&&p(Hi,{serviceRef:e,barRef:t,followRef:u},"error")]})})),uo=y(H.div`
  margin: 0.5rem 0.25rem;
  display: flex;
  position: relative;
`),co=y(H.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
  border-right-width: 0;
  position: relative;
  display: flex;
`),lo=H(w)`
  & input {
    background-color: transparent;
    border: none;
    padding: 0.5rem;
    color: ${({theme:e})=>e.font};
    height: 1rem;
    border: none;
    font-weight: bold;
  }

  & input:focus {
    border: none;
    outline: none;
    font-weight: bold;
    padding-right: 0;
  }

  & ::placeholder {
    color: ${({theme:e})=>e.font};
    font-weight: bold;
  }
`,ho=y(H.div`
  box-sizing: border-box;
  border: 1px dashed ${({theme:e})=>e.fontDarkest};
  color: ${({theme:e})=>e.fontDarkest};
  border-radius: 3px;
  position: relative;
  margin: 0.5rem;
  cursor: pointer;
  font-weight: bold;

  padding: 0 0.25rem;

  :focus {
    outline: none;
  }
`),fo=H.div`
  width: 14px;
  height: 32px;
  display: block;
  position: relative;
  overflow: hidden;
`;y(H(T)`
  display: block;
  font-size: 14px;
`),y(H(K)`
  position: absolute;
`);const po=_.memo((({send:e,index:t,active:n})=>{const r=d.exports.useContext(F),[i,o]=d.exports.useState(!1),[a,c]=h((()=>({background:r.background,color:n?r.font:r.fontDarkest,borderColor:n?r.brand:r.fontDarkest,top:n?-3:0,opacity:1,from:{opacity:0},config:E.stiff})));d.exports.useEffect((()=>{c({top:n?-3:0,color:n?r.font:r.fontDarkest,borderColor:n?r.brand:r.fontDarkest}),n?b():_()}),[n]);const[l,v]=h((()=>({marginTop:n?0:31}))),[g,m]=h((()=>({marginTop:n?-31:0}))),b=()=>{c({background:r.background}),v({marginTop:0}),m({marginTop:-31})},_=()=>{c({background:r.backgroundDark}),v({marginTop:31}),m({marginTop:0})};return d.exports.useEffect((()=>{(n||i)&&b(),!n&&!i&&_()}),[n,i]),p(ho,{style:a,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>e({type:"STAGE.ADD",index:t}),children:f(fo,{children:[p(y.div,{style:u(s({},g),{textAlign:"center",height:"100%",lineHeight:"2rem"}),children:">"}),p(y.div,{style:u(s({},l),{textAlign:"center",height:"100%",lineHeight:"2rem"}),children:"+"})]})})})),yo=y(H.div`
  box-sizing: border-box;
  border: 1px solid ${({theme:e})=>e.brand};
  position: relative;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
  cursor: pointer;
`),vo=y(H.button`
  background-color: ${({theme:e})=>e.backgroundLight};
  border: none;
  padding: 0.5rem;
  color: ${({theme:e})=>e.font};
  height: 1rem;
  display: block;
  height: 100%;
  border: none;
  cursor: pointer;
  font-weight: bold;
  margin: 0;

  :focus {
    outline: none;
  }
`),go=_.memo((({send:e,spring:t})=>p(yo,{style:t,onClick:()=>e("STAGE.DELETE"),children:p(vo,{children:p(O,{style:{fontSize:"14px",display:"block"}})})}))),mo=_.memo((({barRef:e,stageRef:t})=>{const n=d.exports.useContext(F),[r,i]=Rn(t),o=d.exports.useRef(),[a,s]=d.exports.useState({}),{stage:u,stageInfo:c,parameters:l,results:y,currentResult:v,focusOnInit:g,active:m,bestMatch:b}=r.context,_=["input.reading.selected","input.reading.submitted"].some(r.matches),k=h({borderColor:m&&r.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,opacity:1,from:{opacity:0}}),x=h({backgroundColor:_?n.backgroundLight:n.background,borderRightWidth:r.matches("delible.yes")&&l.length?0:1,borderColor:m&&r.matches("focusedViewBar.yes")?n.brand:n.fontDarkest,borderTopRightRadius:l.length?0:3,borderBottomRightRadius:l.length?0:3,opacity:1,from:{opacity:0}}),w=h({top:r.matches("focusedViewBar.yes")&&r.context.active?-3:0,config:E.stiff}),C=r.matches("input.editing");return d.exports.useEffect((()=>{C&&o.current&&o.current.focus(),!C&&o.current&&o.current.blur()}),[C,o.current]),p(S,{children:f(uo,{style:w,ref:e=>e&&e!==a.current&&s({current:e}),children:[f(co,{style:x,children:[p(lo,{placeholder:0===u.length?"+ add stage":"",value:u,autoFocus:g,onFocus:()=>!C&&i("EDIT"),onBlur:e=>{r.matches("input.editing.searchResults.notHovering")&&i("BLUR")},onChange:e=>i({type:"CHANGE",value:e.target.value}),onKeyPress:e=>{if("Enter"===e.key){const t=qi(c.map((e=>e.name)),e.target.value);i({type:"COMMIT",value:t||(b.value?b.value:e.target.value)})}},onKeyDown:e=>{switch(e.key){case"Escape":i("BLUR");break;case"ArrowDown":i("NEXT_RESULT");break;case"ArrowUp":i("PREVIOUS_RESULT");break;case"ArrowRight":e.target.selectionStart===e.target.value.length&&b.value&&i({type:"CHANGE",value:b.value})}},style:{fontSize:"1rem"},ref:o}),r.matches("input.editing")?p(Mi,{children:b?b.placeholder:""}):null,_&&p("div",{style:{width:"1rem",height:"1rem",margin:"0.4rem 0.5rem 0.5rem 0"},children:p(J,{href:`https://voxel51.com/docs/fiftyone/api/fiftyone.core.stages.html#fiftyone.core.stages.${u}`,style:{maxHeight:"1rem",width:"1rem",display:"block"},children:p(P,{style:{width:"1rem",height:"1rem"}})})})]}),l.filter((e=>!e.parameter.startsWith("_"))).map((n=>p(so,{parameterRef:n.ref,barRef:e,stageRef:t},n.parameter))),l.length?p(go,{spring:k,send:i}):null,r.matches("input.editing")&&e.current&&a.current&&p(Bi,{results:y,send:i,currentResult:v,bestMatch:b.value,followRef:a,barRef:e}),a.current&&p(Hi,{serviceRef:t,followRef:a,barRef:e})]})})})),{choose:bo}=bn,_o=(e,t,n,r,i,o,a,s,u,c,l)=>({id:z(),defaultValue:i,parameter:n,type:r,stage:t,value:o||"",submitted:a,focusOnInit:s,inputRef:{},tail:u,currentResult:null,results:[],active:c,placeholder:l,fieldNames:e}),ko=Yt({id:"viewStage",context:{id:void 0,stage:void 0,parameters:[],prevStage:"",stageInfo:void 0,index:void 0,focusOnInit:void 0,length:void 0,inputRef:{},fieldNames:[]},type:"parallel",states:{input:{initial:"decide",states:{hist:{type:"history"},decide:{always:[{target:"initializing",cond:e=>e.parameters.length&&!e.parameters[0].ref},{target:"waiting",cond:e=>!e.inputRef},{target:"editing",cond:({focusOnInit:e})=>e},{target:"reading"}]},initializing:{entry:Ct({parameters:e=>e.parameters.map((e=>u(s({},e),{ref:yn(Ji.withContext(e))})))}),always:"decide"},waiting:{on:{FOCUS:{target:"decide",actions:Ct({inputRef:(e,{inputRef:t})=>t})}}},reading:{entry:"blurInput",initial:"decide",states:{decide:{always:[{target:"pending",cond:e=>{return t=e.stageInfo,n=e.stage,!t.map((e=>e.name)).some((e=>e.toLowerCase()===n.toLowerCase()));var t,n}},{target:"selected"}]},hist:{type:"history"},pending:{},selected:{},submitted:{}},on:{EDIT:{target:"editing",actions:kt((({index:e})=>({type:"STAGE.EDIT",index:e})))},DELETE:{target:"deleted"}}},editing:{entry:[Ct({prevStage:e=>e.stage,prevSubmitted:e=>e.submitted,results:({stageInfo:e,stage:t})=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.toLowerCase()))),currentResult:null,focusOnInit:!0,bestMatch:({stageInfo:e,stage:t})=>Vi(e.map((e=>e.name)),t)})],type:"parallel",states:{input:{initial:"focused",states:{focused:{entry:"focusInput",on:{UNFOCUS_INPUT:"unfocused"}},unfocused:{on:{FOCUS_INPUT:"focused"}}}},searchResults:{initial:"notHovering",states:{hovering:{on:{MOUSELEAVE:"notHovering"}},notHovering:{on:{MOUSEENTER:"hovering"}}}}},on:{CHANGE:{actions:Ct({stage:(e,t)=>t.value,results:({stageInfo:e},t)=>e.map((e=>e.name)).filter((e=>e.toLowerCase().startsWith(t.value.toLowerCase()))),currentResult:null,errorId:void 0,bestMatch:({stageInfo:e},{value:t})=>Vi(e.map((e=>e.name)),t)})},COMMIT:[{target:"reading.selected",actions:[Ct({focusOnInit:!1,stage:(e,{value:t})=>e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].name,parameters:(e,{value:t})=>{const n=e.stageInfo.filter((e=>e.name.toLowerCase().startsWith(t.toLowerCase())))[0].params;return n.map(((r,i)=>_o(e.fieldNames,t,r.name,r.type,r.default,r.name.startsWith("_")?r.default:"",r.name.startsWith("_"),0===i,i===n.length-1,e.active,r.placeholder))).map((e=>u(s({},e),{ref:yn(Ji.withContext(e))})))},errorId:void 0}),_t("UPDATE_DELIBLE"),"blurInput"],cond:({stageInfo:e},{value:t})=>qi(e.map((e=>e.name)),t)},{actions:[Ct({submitted:()=>!1,error:(e,{value:t})=>({name:"stage",error:`${""===t?'""':t} is not a valid stage`}),errorId:z()})]}],BLUR:[{target:"deleted",cond:e=>0===e.parameters.length},{target:"reading.pending",actions:[Ct({focusOnInit:!1}),"blurInput"]}]}},deleted:{onEntry:[Ct({stage:"",submitted:!1,parameters:[]}),kt((e=>({type:"STAGE.DELETE",stage:e})))],always:"reading.pending"}}},delible:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.length>1||e.submitted||""!==e.stage},{target:"no"}]},yes:{},no:{}}},draggable:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>1===e.length},{target:"no"}]},yes:{},no:{}}},focusedViewBar:{initial:"decide",states:{decide:{always:[{target:"yes",cond:e=>e.focusOnInit},{target:"no"}]},yes:{},no:{}}}},on:{CLEAR_ERROR:{actions:[Ct({error:void 0})]},CLEAR_ERROR_ID:{actions:[Ct({errorId:void 0})]},NEXT_RESULT:{actions:Ct({currentResult:({currentResult:e,results:t})=>null===e?0:Math.min(e+1,t.length-1),stage:({currentResult:e,results:t})=>null===e?t[0]:t[Math.min(e+1,t.length-1)],bestMatch:{}})},PREVIOUS_RESULT:{actions:Ct({currentResult:({currentResult:e})=>0===e||null===e?null:e-1,stage:({currentResult:e,prevStage:t,results:n})=>0===e||null===e?t:n[e-1],bestMatch:{}})},BAR_FOCUS:"focusedViewBar.yes",BAR_BLUR:"focusedViewBar.no",UPDATE_DELIBLE:"delible","STAGE.UPDATE":{target:["draggable","delible","input"],actions:[Ct({index:(e,{index:t})=>t,length:(e,{length:t})=>t,active:(e,{active:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),(e,{active:t})=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:t})))}]},"STAGE.DELETE":[{target:"input.deleted"}],"PARAMETER.COMMIT":{target:"input",actions:[Ct({parameters:(e,t)=>e.parameters.map((e=>e.id===t.parameter.id?u(s({},t.parameter),{ref:e.ref}):e))}),bo([{cond:e=>e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0)>0,actions:_t("EDIT",{to:(e,t)=>{const n=e.parameters.reduce(((e,n,r)=>n.id===t.parameter.id?r:e),void 0);let r=n+1;for(;r<e.parameters.length;){if(!e.parameters[r].submitted)return e.parameters[r].ref;r+=1}for(r=n-1;r>=0;){if(!e.parameters[r].submitted)return e.parameters[r].ref;r-=1}}})},{cond:e=>0===e.parameters.reduce(((e,t)=>t.submitted?e:e+1),0),actions:[Ct({submitted:!0,focusOnInit:!1,active:!1}),e=>{e.parameters.forEach((e=>e.ref.send({type:"UPDATE",active:!1})))},kt((e=>({type:"STAGE.COMMIT",stage:e})))]}])]},"PARAMETER.EDIT":{actions:[kt((e=>({type:"STAGE.EDIT",index:e.index})))]}}},{actions:{focusInput:()=>{},blurInput:()=>{}}}),{choose:Eo}=bn,So=(e,t,n,r,i,o,a,s,u,c,l)=>({id:t||z(),stage:n,parameters:u,stageInfo:i,index:r,focusOnInit:o,length:a,active:s,inputRef:{},submitted:c,loaded:l,fieldNames:e});function xo(e,t,n,r=!0,i){return e.split("|").reduce(((e,o)=>{if(void 0!==e)return e;const a=Wi[o];return a.validate(r?n:a.castFrom(n,i),i)?a[t](n,i):e}),void 0)}function wo(e,t,n){return 1===e.length&&""===e[0].stage?[]:e.map((e=>function(e,t,n){return{kwargs:e.parameters.map(((r,i)=>[r.parameter,xo(t[e.stage][i].type,"castTo",r.value,!0,n)])),_uuid:e.id,_cls:`fiftyone.core.stages.${e.stage}`}}(e,t,n)))}function Co(e,t){const n=So(e,null,"",0,t,!1,1,!0,[],!1);return[u(s({},n),{ref:yn(ko.withContext(n))})]}function Io(e,t){const n=e.view,r=Object.fromEntries(t.map((e=>[e.name,e.params])));return X(n,wo(e.stages,r,e.fieldNames))?e.stages:0===n.length?Co(e.fieldNames,t):n.map(((r,i)=>{let o=r._cls.split(".");o=o[o.length-1];const a=So(e.fieldNames,r._uuid,o,i,t,!1,e.stages.length,i===Math.min(n.length-1,e.activeStage),r.kwargs.map(((r,a)=>{const s=t.filter((e=>e.name===o))[0];return _o(e.fieldNames,o,r[0],s.params[a].type,s.params[a].default,xo(s.params[a].type,"castFrom",r[1],!1,e.fieldNames),!0,!1,a===s.params.length-1,i===Math.min(n.length-1,e.activeStage),s.params[a].placeholder)})),!0,!0);return u(s({},a),{ref:yn(ko.withContext(a))})}))}const To=Yt({id:"stages",context:{stages:[],stageInfo:void 0,activeStage:0,view:void 0,setView:void 0,http:void 0,fieldNames:[]},initial:"initializing",states:{decide:{always:[{target:"running.hist",cond:e=>e.stageInfo&&e.view,actions:[Ct({stages:e=>Io(e,e.stageInfo)})]},{target:"loading"}]},initializing:{},loading:{invoke:{src:function(e){return U()("GET","/stages")},onDone:{target:"running",actions:Ct({stageInfo:(e,t)=>t.data.stages,stages:(e,t)=>0===e.view.length?Co(e.fieldNames,t.data.stages):Io(e,t.data.stages)})}}},running:{type:"parallel",states:{focus:{initial:"blurred",states:{focused:{entry:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_FOCUS"})))],exit:[({stages:e})=>e.forEach((e=>e.ref.send({type:"BAR_BLUR"})))],on:{TOGGLE_FOCUS:{target:"blurred"},NEXT:{actions:[Ct({activeStage:({stages:e,activeStage:t})=>{const n=t;return n===e.length-.5?n:n%1!=0?Math.ceil(n):e[n].submitted&&(n===e.length-1||e[n+1].submitted)?n+.5:Math.min(e.length-1,n+1)}}),"sendStagesUpdate"]},PREVIOUS:{actions:[Ct({activeStage:({stages:e,activeStage:t})=>{const n=t;return-.5===n?n:n%1!=0?Math.floor(n):e[n].submitted&&(0===n||e[n-1].submitted)?n-.5:Math.max(0,n-1)}}),"sendStagesUpdate"]},NEXT_STAGE:{actions:[Ct({activeStage:({stages:e,activeStage:t})=>Math.min(Math.floor(t+1),e.length-1)}),"sendStagesUpdate"]},PREVIOUS_STAGE:{actions:[Ct({activeStage:({stages:e,activeStage:t})=>Math.max(Math.ceil(t-1),0)}),"sendStagesUpdate"]},NEXT_RESULT:{actions:_t((({stages:e,activeStage:t})=>({type:"NEXT_RESULT",to:e[t].ref})))},PREVIOUS_RESULT:{actions:_t((({stages:e,activeStage:t})=>({type:"PREVIOUS_RESULT",to:e[t].ref})))},DELETE_ACTIVE_STAGE:{actions:_t((({activeStage:e,stages:t})=>({type:"STAGE.DELETE",stage:t[e]})))},ENTER:{actions:[Eo([{actions:_t((({activeStage:e})=>({type:"STAGE.ADD",index:Math.ceil(e)}))),cond:({activeStage:e})=>.5===Math.abs(e%1)},{actions:_t((({stages:e,activeStage:t})=>{e[t].ref.send({type:"EDIT"})}))}])]}}},blurred:{on:{TOGGLE_FOCUS:{target:"focused"}}}}},hovering:{initial:"no",states:{yes:{on:{MOUSELEAVE:"no"}},no:{on:{MOUSEENTER:"yes"}}}},hist:{type:"history",history:"deep"}}}},on:{"STAGE.EDIT":{actions:[Ct({activeStage:(e,t)=>t.index}),"sendStagesUpdate"]},"STAGE.ADD":{actions:[Ct({activeStage:(e,{index:t})=>t,stages:(e,{index:t})=>{const n=So(e.fieldNames,null,"",t,e.stageInfo,!0,e.stages.length+1,!0,[],!1);return n.added=!0,[...e.stages.slice(0,t),u(s({},n),{ref:yn(ko.withContext(n))}),...e.stages.slice(t)].map(((t,n)=>u(s({},t),{index:n,active:n==n,length:e.stages.length+1})))}}),"sendStagesUpdate"]},"STAGE.COMMIT":{actions:[Ct({stages:({stages:e},t)=>(e[t.stage.index]=u(s({},t.stage),{ref:e[t.stage.index].ref}),e),activeStage:({activeStage:e})=>e+.5}),"submit"]},CLEAR:{actions:[Ct({stages:e=>{const t=So(e.fieldNames,null,"",0,e.stageInfo,!1,0,!0,[],!1);return[u(s({},t),{ref:yn(ko.withContext(t))})]}}),"submit"]},"STAGE.DELETE":{actions:[Ct({activeStage:({activeStage:e})=>Math.max(e-1,0),stages:({fieldNames:e,stages:t,stageInfo:n},r)=>{if(1===t.length&&t[0].id===r.stage.id){const t=So(e,null,"",0,n,!1,0,!0,[],!1);return[u(s({},t),{ref:yn(ko.withContext(t))})]}return t.filter((e=>e.id!==r.stage.id||1===t.length)).map(((e,n)=>{const i=e.id===r.stage.id?r.stage:e;return i.index=n,i.length=Math.max(t.length-1,1),i}))}}),"submit"]},UPDATE:{target:"decide",actions:[Ct({http:(e,{http:t})=>t,view:(e,{view:t})=>t,setView:(e,{setView:t})=>t,fieldNames:(e,{fieldNames:t})=>t}),"sendStagesUpdate"]}}},{actions:{sendStagesUpdate:e=>{e.stages.forEach((t=>t.ref.send({type:"STAGE.UPDATE",index:t.index,length:e.stages.length,active:t.index===e.activeStage,stage:t.stage,fieldNames:e.fieldNames})))},submit:({stages:e,stageInfo:t,fieldNames:n,setView:r,view:i})=>{const o=wo(e,Object.fromEntries(t.map((e=>[e.name,e.params]))),n);X(o,i)||r(o)}}}),Ko=H.div`
  position: relative;
  background-color: ${({theme:e})=>e.backgroundDark};
  border-radius: 3px;
  border: 1px solid ${({theme:e})=>e.backgroundDarkBorder};
  box-sizing: border-box;
  height: 52px;
  width: 100%;
  display: flex;
  overflow-x: scroll;
  scrollbar-width: none;
  min-width: 200px;

  &::-webkit-scrollbar {
    width: 0px;
    background: transparent;
    display: none;
  }
  &::-webkit-scrollbar-thumb {
    width: 0px;
    display: none;
  }
`,Oo=H.div`
  display: flex;
  align-items: center;
  position: absolute;
  z-index: 904;
  height: 100%;
  border-radius: 3px;
top 0;
  height: 52px;
  right: 0;
  background-image: linear-gradient(
    to right,
    rgba(0, 0, 0, 0),
    30%,
    ${({theme:e})=>e.backgroundDark}
  );
  column-gap: 0.5rem;
  padding: 0 0.5rem;
`,Po={VIEW_BAR_NEXT:"right",VIEW_BAR_PREVIOUS:"left",VIEW_BAR_NEXT_STAGE:"shift+right",VIEW_BAR_PREVIOUS_STAGE:"shift+left",VIEW_BAR_DELETE:["del","backspace"],VIEW_BAR_ENTER:"enter"},Ro=_.memo((()=>{const[e,t]=function(e,t){void 0===t&&(t={});var n=d.exports.useCallback((function(e){var t=void 0===e.changed&&Object.keys(e.children).length;(e.changed||t)&&a(e)}),[]),r=In(e,t,n),i=Tn(d.exports.useState((function(){var e=r.machine.initialState;return t.state?Bt.create(t.state):e})),2),o=i[0],a=i[1];return[o,r.send,r]}(To),n=j(Q),r=Y(),i=j(Z({}));d.exports.useEffect((()=>{t({type:"UPDATE",http:ee,view:n,setView:e=>r({view:e}),fieldNames:i})}),[ee,n]);const{stages:o,activeStage:a}=e.context,s=d.exports.useRef(null),u={VIEW_BAR_NEXT:d.exports.useCallback((()=>t("NEXT")),[]),VIEW_BAR_PREVIOUS:d.exports.useCallback((()=>t("PREVIOUS")),[]),VIEW_BAR_NEXT_STAGE:d.exports.useCallback((()=>t("NEXT_STAGE")),[]),VIEW_BAR_PREVIOUS_STAGE:d.exports.useCallback((()=>t("PREVIOUS_STAGE")),[]),VIEW_BAR_DELETE:d.exports.useCallback((()=>t("DELETE_ACTIVE_STAGE")),[]),VIEW_BAR_ENTER:d.exports.useCallback((e=>{e.preventDefault(),t("ENTER")}),[])};return q(s,(()=>e.matches("running.focus.focused")&&t("TOGGLE_FOCUS"))),f("div",{style:{position:"relative",flex:"1",marginRight:"0.5rem",overflow:"hidden"},children:[p(Ln.exports.GlobalHotKeys,{handlers:u,keyMap:Po}),f(Ko,{onClick:()=>e.matches("running.focus.blurred")&&t("TOGGLE_FOCUS"),ref:s,children:[e.matches("running")?o.map(((n,r)=>f(_.Fragment,{children:[n.submitted&&(0===r||o[r-1].submitted)?p(po,{send:t,index:r,active:a===r-.5&&e.matches("running.focus.focused")},`insert-button-${n.id}`):null,p(mo,{stageRef:n.ref,barRef:s},n.id)]},n.id))):null,e.matches("running")&&o[o.length-1].submitted?p(po,{send:t,index:o.length,active:a===o.length-.5&&e.matches("running.focus.focused")},"insert-button-tail"):null,p("div",{style:{display:"block",minWidth:64,maxWidth:64,height:"100%"}})]}),f(Oo,{children:[p(O,{onClick:()=>t("CLEAR"),style:{cursor:"pointer"}}),p(J,{href:"https://voxel51.com/docs/fiftyone/user_guide/app.html#using-the-view-bar",style:{display:"flex"},children:p(P,{})})]})]})}));var Lo="_page_8fb7q_1";const Ao=({className:e,value:t})=>p(se,{title:t,className:e,to:`/datasets/${t}`,children:t}),Mo=e=>{const t=L(te),n=(r=e.datasets,e=>{const{data:t,refetch:n}=R.usePaginationFragment(de,r);return he((()=>{n({search:e})}),200,[e]),d.exports.useMemo((()=>({total:t.datasets.total,values:t.datasets.edges.map((e=>e.node.name))})),[t])});var r;const i=(()=>{const e=d.exports.useContext(D),[t,n]=d.exports.useTransition();return{pending:t,start:d.exports.useCallback((t=>()=>e.preload(t)),[e]),to:d.exports.useCallback((t=>n((()=>((e,t)=>{e.history.push(t)})(e,t)))),[e])}})();return f(ne,{title:"FiftyOne Teams",onRefresh:()=>{},datasetSelectorProps:{component:Ao,onSelect:e=>{i.start(e),i.to(e)},placeholder:"Select dataset",useSearch:n,value:t||""},children:[t&&p(Ro,{}),!t&&p("div",{style:{flex:1}}),f("div",{className:B,children:[p(ie,{}),p(oe,{}),p(ae,{})]})]})};export default({children:e,prepared:t})=>{const n=R.usePreloadedQuery(l,t);return f(S,{children:[p(Mo,{datasets:n}),p("div",{className:Lo,children:p(d.exports.Suspense,{fallback:null,children:e})})]})};
