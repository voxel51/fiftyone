input Aggregate {
  count: Count = null
  countValues: CountValues = null
  histogramValues: HistogramValues = null
}

union AggregateResult =
    BooleanAggregation
  | DataAggregation
  | IntAggregation
  | FloatAggregation
  | RootAggregation
  | StringAggregation

interface Aggregation {
  path: String!
  count: Int!
  exists: Int!
}

input AggregationForm {
  dataset: String!
  extendedStages: BSONArray!
  filters: BSON
  groupId: ID
  hiddenLabels: [SelectedLabel!]!
  index: Int
  mixed: Boolean!
  paths: [String!]!
  sampleIds: [ID!]!
  slices: [String!]
  view: BSONArray!
  viewName: String = null
}

union AggregationResponses =
    CountResponse
  | BoolCountValuesResponse
  | IntCountValuesResponse
  | StrCountValuesResponse
  | DatetimeHistogramValuesResponse
  | FloatHistogramValuesResponse
  | IntHistogramValuesResponse

type AppConfig {
  colorBy: ColorBy!
  colorPool: [String!]!
  colorscale: String!
  gridZoom: Int!
  loopVideos: Boolean!
  notebookHeight: Int!
  plugins: JSON
  showConfidence: Boolean!
  showIndex: Boolean!
  showLabel: Boolean!
  showSkeletons: Boolean!
  showTooltip: Boolean!
  sidebarMode: SidebarMode!
  theme: Theme!
  timezone: String
  useFrameNumber: Boolean!
  spaces: JSON
}

scalar BSON

scalar BSONArray

type BoolCountValuesResponse {
  values: [BoolValueCount!]!
}

type BoolValueCount {
  key: Boolean
  value: Int!
}

type BooleanAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
  false: Int!
  true: Int!
}

type BrainRun implements Run {
  key: String!
  version: String
  timestamp: datetime
  config: BrainRunConfig
  viewStages: [String!]
}

type BrainRunConfig implements RunConfig {
  cls: String!
  embeddingsField: String
  method: String
  patchesField: String
  supportsPrompts: Boolean
  type: BrainRunType
  maxK: Int
  supportsLeastSimilarity: Boolean
}

enum BrainRunType {
  similarity
  visualization
}

enum ColorBy {
  field
  instance
  value
}

type ColorScheme {
  colorPool: [String!]
  fields: [CustomizeColor!]
}

input ColorSchemeInput {
  colorPool: [String!] = null
  fields: JSONArray = null
}

input Count {
  field: String!
}

type CountResponse {
  count: Int!
}

input CountValues {
  field: String!
}

type CustomizeColor {
  path: String!
  fieldColor: String
  colorByAttribute: String
  valueColors: [LabelSetting!]
}

type DataAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
}

type Dataset {
  id: ID!
  name: String!
  createdAt: date
  lastLoadedAt: datetime
  persistent: Boolean!
  groupMediaTypes: [Group!]
  groupField: String
  groupSlice: String
  defaultGroupSlice: String
  mediaType: MediaType
  parentMediaType: MediaType
  maskTargets: [NamedTargets!]!
  defaultMaskTargets: [Target!]
  sampleFields: [SampleField!]!
  frameFields: [SampleField!]
  brainMethods: [BrainRun!]
  evaluations: [EvaluationRun!]
  savedViewSlug: String
  savedViews: [SavedView!]
  version: String
  viewCls: String
  viewName: String
  defaultSkeleton: KeypointSkeleton
  skeletons: [NamedKeypointSkeleton!]!
  appConfig: DatasetAppConfig
  info: JSON
  stages(slug: String = null): BSONArray
}

type DatasetAppConfig {
  mediaFields: [String!]
  plugins: JSON
  sidebarGroups: [SidebarGroup!]
  sidebarMode: SidebarMode
  modalMediaField: String
  gridMediaField: String
  spaces: JSON
  colorScheme: ColorScheme
}

type DatasetStrConnection {
  pageInfo: DatasetStrPageInfo!
  edges: [DatasetStrEdge!]!
  total: Int
}

type DatasetStrEdge {
  node: Dataset!
  cursor: String!
}

type DatasetStrPageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
  endCursor: String
}

type DatetimeHistogramValuesResponse {
  counts: [Int!]!
  edges: [datetime!]!
  other: Int!
}

type EvaluationRun implements Run {
  key: String!
  version: String
  timestamp: datetime
  config: EvaluationRunConfig
  viewStages: [String!]
}

type EvaluationRunConfig implements RunConfig {
  cls: String!
  gtField: String
  predField: String
  method: String
}

input ExtendedViewForm {
  filters: JSON = null
  mixed: Boolean = null
  sampleIds: [String!] = null
  slice: String = null
}

type FloatAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
  inf: Int!
  max: Float
  min: Float
  nan: Int!
  ninf: Int!
}

type FloatHistogramValuesResponse {
  counts: [Int!]!
  edges: [Float!]!
  other: Int!
}

type Group {
  name: String!
  mediaType: MediaType!
}

input GroupElementFilter {
  id: String = null
  slice: String = null
  slices: [String!] = null
}

input HistogramValues {
  field: String!
}

type ImageSample implements Sample {
  id: ID!
  sample: JSON!
  urls: [MediaURL!]!
  aspectRatio: Float!
}

type IntAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
  max: Float
  min: Float
}

type IntCountValuesResponse {
  values: [IntValueCount!]!
}

type IntHistogramValuesResponse {
  counts: [Int!]!
  edges: [Float!]!
  other: Int!
}

type IntValueCount {
  key: Int
  value: Int!
}

scalar JSON

scalar JSONArray

type KeypointSkeleton {
  labels: [String!]
  edges: [[Int!]!]!
}

type LabelSetting {
  value: String!
  color: String!
}

enum MediaType {
  image
  group
  point_cloud
  video
}

type MediaURL {
  field: String!
  url: String
}

type Mutation {
  setDataset(
    subscription: String!
    session: String
    name: String
    viewName: String
  ): Boolean!
  setSidebarGroups(
    subscription: String!
    session: String
    dataset: String!
    stages: BSONArray!
    sidebarGroups: [SidebarGroupInput!]!
  ): Boolean!
  setSelected(
    subscription: String!
    session: String
    selected: [String!]!
  ): Boolean!
  setSelectedLabels(
    subscription: String!
    session: String
    selectedLabels: [SelectedLabel!]!
  ): Boolean!
  setView(
    subscription: String!
    session: String
    datasetName: String!
    view: BSONArray
    savedViewSlug: String
    form: StateForm
  ): ViewResponse!
  storeTeamsSubmission: Boolean!
  setGroupSlice(
    subscription: String!
    session: String
    view: BSONArray!
    slice: String!
    viewName: String = null
  ): Dataset!
  createSavedView(
    subscription: String!
    session: String
    viewName: String!
    viewStages: BSONArray = null
    form: StateForm = null
    datasetName: String = null
    description: String = null
    color: String = null
  ): SavedView
  deleteSavedView(
    subscription: String!
    session: String
    viewName: String!
    datasetName: String
  ): String
  updateSavedView(
    viewName: String!
    subscription: String
    session: String
    updatedInfo: SavedViewInfo!
    datasetName: String = null
  ): SavedView
  setSpaces(subscription: String!, session: String, spaces: BSON!): Boolean!
  setColorScheme(
    subscription: String!
    session: String
    dataset: String!
    stages: BSONArray!
    colorScheme: ColorSchemeInput!
    saveToApp: Boolean!
  ): Boolean!
  searchSelectFields(datasetName: String!, metaFilter: JSON): [String!]!
}

type NamedKeypointSkeleton {
  labels: [String!]
  edges: [[Int!]!]!
  name: String!
}

type NamedTargets {
  name: String!
  targets: [Target!]!
}

type PointCloudSample implements Sample {
  id: ID!
  sample: JSON!
  urls: [MediaURL!]!
  aspectRatio: Float!
}

type Query {
  aggregate(
    datasetName: String!
    view: BSONArray
    aggregations: [Aggregate!]!
    viewName: String = null
    form: ExtendedViewForm = null
  ): [AggregationResponses!]!
  dataset(name: String!, view: BSONArray, savedViewSlug: String): Dataset
  datasets(
    search: String
    first: Int = 200
    after: String = null
  ): DatasetStrConnection!
  aggregations(form: AggregationForm!): [AggregateResult!]!
  colorscale: [[Int!]!]
  config: AppConfig!
  context: String!
  dev: Boolean!
  doNotTrack: Boolean!
  samples(
    dataset: String!
    view: BSONArray!
    first: Int = 20
    after: String = null
    filter: SampleFilter = null
    filters: BSON = null
    extendedStages: BSON = null
    paginationData: Boolean = true
  ): SampleItemStrConnection!
  sample(
    dataset: String!
    view: BSONArray!
    filter: SampleFilter!
    filters: JSON = null
  ): SampleItem
  teamsSubmission: Boolean!
  uid: String!
  version: String!
  savedViews(datasetName: String!): [SavedView!]
  schemaForViewStages(
    datasetName: String!
    viewStages: BSONArray!
  ): SchemaResult!
}

type RootAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
  slice: Int
  expandedFieldCount: Int!
  frameLabelFieldCount: Int
}

interface Run {
  key: String!
  version: String
  timestamp: datetime
  config: RunConfig
  viewStages: [String!]
}

interface RunConfig {
  cls: String!
}

interface Sample {
  id: ID!
  sample: JSON!
  urls: [MediaURL!]!
  aspectRatio: Float!
}

type SampleField {
  ftype: String!
  path: String!
  subfield: String
  embeddedDocType: String
  dbField: String
  description: String
  info: JSON
}

input SampleFilter {
  id: String = null
  group: GroupElementFilter = null
}

union SampleItem = ImageSample | PointCloudSample | VideoSample

type SampleItemStrConnection {
  pageInfo: SampleItemStrPageInfo!
  edges: [SampleItemStrEdge!]!
  total: Int
}

type SampleItemStrEdge {
  node: SampleItem!
  cursor: String!
}

type SampleItemStrPageInfo {
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
  endCursor: String
}

type SavedView {
  id: String
  datasetId: String
  name: String
  description: String
  color: String
  slug: String
  viewStages: [String!]
  createdAt: datetime
  lastModifiedAt: datetime
  lastLoadedAt: datetime
  viewName: String
  stageDicts: BSONArray
}

input SavedViewInfo {
  name: String = null
  description: String = null
  color: String = null
}

type SchemaResult {
  fieldSchema: [SampleField!]!
  frameFieldSchema: [SampleField!]!
}

input SelectedLabel {
  labelId: ID!
  field: String!
  sampleId: ID!
  frameNumber: Int = null
}

type SidebarGroup {
  name: String!
  paths: [String!]
  expanded: Boolean
}

input SidebarGroupInput {
  name: String!
  paths: [String!]
  expanded: Boolean = null
}

enum SidebarMode {
  all
  best
  fast
}

input StateForm {
  addStages: BSONArray = null
  filters: JSON = null
  sampleIds: [String!] = null
  labels: [SelectedLabel!] = null
  extended: BSON = null
  slice: String = null
}

type StrCountValuesResponse {
  values: [StrValueCount!]!
}

type StrValueCount {
  key: String
  value: Int!
}

type StringAggregation implements Aggregation {
  path: String!
  count: Int!
  exists: Int!
  values: [StringAggregationValue!]!
}

type StringAggregationValue {
  count: Int!
  value: String!
}

type Target {
  target: String!
  value: String!
}

enum Theme {
  browser
  dark
  light
}

type VideoSample implements Sample {
  id: ID!
  sample: JSON!
  urls: [MediaURL!]!
  aspectRatio: Float!
  frameNumber: Int!
  frameRate: Float!
}

type ViewResponse {
  view: BSONArray!
  dataset: Dataset!
}

scalar date

scalar datetime
